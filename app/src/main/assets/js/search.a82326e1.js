"use strict";(self["webpackChunkkomga_webui"]=self["webpackChunkkomga_webui"]||[]).push([[187],{1324:function(e,t,s){s.d(t,{A:function(){return u}});var i=s(3224),o=s(16684),n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"text-center"},[t(i.A,{attrs:{color:"contrast-1",size:e.size}},[t("div",[""!==e.icon?t(o.A,{attrs:{color:e.iconColor,size:e.iconSize}},[e._v(e._s(e.icon)+" ")]):e._e(),t("h1",{staticClass:"text-h5"},[e._v(e._s(e.title))]),t("p",{staticClass:"text-body-1"},[e._v(e._s(e.subTitle))]),e._t("default")],2)])],1)},l=[],a=s(85471),r=a.Ay.extend({name:"EmptyState",props:{title:String,subTitle:String,icon:String,iconColor:String,iconSize:{type:[Number,String],default:140},size:{type:[Number,String],default:400}}}),d=r,c=s(81656),h=(0,c.A)(d,n,l,!1,null,"64f4a2b5",null),u=h.exports},81301:function(e,t,s){s.d(t,{A:function(){return v}});var i=s(73847);function o(e,t,s){const i=t.modifiers||{},o=t.value,l="object"===typeof o?o.handler:o,{once:a,...r}=i,d=Object.keys(r).length>0,c="object"===typeof o&&o.options?o.options:d?{attributes:r.attr,childList:r.child,subtree:r.sub,characterData:r.char}:{attributes:!0,childList:!0,subtree:!0,characterData:!0},h=new MutationObserver(((i,o)=>{e._mutate&&(l(i,o),a&&n(e,t,s))}));h.observe(e,c),e._mutate=Object(e._mutate),e._mutate[s.context._uid]={observer:h}}function n(e,t,s){var i;(null===(i=e._mutate)||void 0===i?void 0:i[s.context._uid])&&(e._mutate[s.context._uid].observer.disconnect(),delete e._mutate[s.context._uid])}const l={inserted:o,unbind:n};var a=l,r=s(8177),d=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticStyle:{position:"relative"}},[t("div",{staticStyle:{"min-height":"36px"}},[e._t("prepend")],2),t("div",{style:"position: absolute; top: 0;"+(e.$vuetify.rtl?"left: 0":"right: 0")},[t(i.A,{attrs:{icon:"",disabled:!e.canScrollBackward},on:{click:function(t){return e.doScroll("backward")}}},[t("rtl-icon",{attrs:{icon:"mdi-chevron-left",rtl:"mdi-chevron-right"}})],1),t(i.A,{attrs:{icon:"",disabled:!e.canScrollForward},on:{click:function(t){return e.doScroll("forward")}}},[t("rtl-icon",{attrs:{icon:"mdi-chevron-right",rtl:"mdi-chevron-left"}})],1)],1),t("div",{directives:[{def:r.A,name:"resize",rawName:"v-resize",value:e.computeScrollability,expression:"computeScrollability"}],ref:e.id,staticClass:"scrolling-wrapper",attrs:{id:e.id},on:{scroll:e.computeScrollability}},[t("div",{directives:[{def:a,name:"mutate",rawName:"v-mutate",value:e.computeScrollability,expression:"computeScrollability"}],staticClass:"d-inline-flex"},[e._t("content"),e._t("content-append")],2)])])},c=[],h=s(85471),u=s(24636),m=h.Ay.extend({name:"HorizontalScroller",components:{RtlIcon:u.A},data:function(){const e=this.$_.uniqueId();return{id:e,canScrollBackward:!1,canScrollForward:!0,container:this.$refs[e],adjustment:100}},props:{tick:{type:Number,default:0}},mounted(){this.container=this.$refs[this.id],this.computeScrollability()},watch:{tick(){setTimeout(this.computeScrollability,200)}},methods:{computeScrollability(){if(this.container){let e;this.$vuetify.rtl?(this.canScrollBackward=Math.round(this.container.scrollLeft)<0,this.canScrollForward=Math.round(this.container.scrollLeft)-this.container.clientWidth>-this.container.scrollWidth,e=(Math.round(this.container.scrollLeft)-this.container.clientWidth)/-this.container.scrollWidth):(this.canScrollBackward=Math.round(this.container.scrollLeft)>0,this.canScrollForward=Math.round(this.container.scrollLeft)+this.container.clientWidth<this.container.scrollWidth,e=(Math.round(this.container.scrollLeft)+this.container.clientWidth)/this.container.scrollWidth),this.$emit("scroll-changed",e)}},doScroll(e){if(void 0!==this.container){let t,s=this.container.clientWidth-this.adjustment,i=Math.round(this.container.scrollLeft);t=this.$vuetify.rtl?"backward"===e?i+s:i-s:"backward"===e?i-s:i+s,this.container.scrollTo({top:0,left:t,behavior:"smooth"})}}}}),p=m,f=s(81656),g=(0,f.A)(p,d,c,!1,null,"6ff71d44",null),v=g.exports},24636:function(e,t,s){s.d(t,{A:function(){return h}});var i=s(16684),o=function(){var e=this,t=e._self._c;e._self._setupProxy;return e.$vuetify.rtl?t(i.A,[e._v(e._s(e.rtl))]):t(i.A,[e._v(e._s(e.icon))])},n=[],l=s(85471),a=l.Ay.extend({name:"RtlIcon",props:{icon:{type:String,required:!0},rtl:{type:String,required:!0}}}),r=a,d=s(81656),c=(0,d.A)(r,o,n,!1,null,"56a7313c",null),h=c.exports},78892:function(e,t,s){s.d(t,{A:function(){return v}});var i=s(73847),o=s(16684),n=s(80700),l=s(40005),a=s(26702),r=s(84551),d=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(n.Yt,{attrs:{"hide-on-leave":""}},[e.value.length>0?t("toolbar-sticky",{attrs:{elevation:5,color:"base"}},[t(i.A,{attrs:{icon:""},on:{click:e.unselectAll}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-close")])]}}],null,!1,4258196469)},[t("span",[e._v(e._s(e.$t("menu.deselect_all")))])])],1),e.showSelectAll?t(i.A,{attrs:{icon:""},on:{click:e.selectAll}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-select-all")])]}}],null,!1,848294631)},[t("span",[e._v(e._s(e.$t("menu.select_all")))])])],1):e._e(),t(a.sw,{staticClass:"mx-2"},[t("span",[e._v(e._s(e.$tc("common.n_selected",e.value.length)))])]),t(l.A),"books"===e.kind||"series"===e.kind?t(i.A,{attrs:{icon:""},on:{click:e.markRead}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-bookmark-check")])]}}],null,!1,2944767412)},[t("span",[e._v(e._s(e.$t("menu.mark_read")))])])],1):e._e(),"books"===e.kind||"series"===e.kind?t(i.A,{attrs:{icon:""},on:{click:e.markUnread}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-bookmark-remove")])]}}],null,!1,2589859700)},[t("span",[e._v(e._s(e.$t("menu.mark_unread")))])])],1):e._e(),e.isAdmin&&("series"===e.kind||"books"===e.kind&&e.oneshots)?t(i.A,{attrs:{icon:""},on:{click:e.addToCollection}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-playlist-plus")])]}}],null,!1,855572914)},[t("span",[e._v(e._s(e.$t("menu.add_to_collection")))])])],1):e._e(),!e.isAdmin||"books"!==e.kind&&"series"!==e.kind?e._e():t(i.A,{attrs:{icon:""},on:{click:e.addToReadList}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-book-plus-multiple")])]}}],null,!1,3391873344)},[t("span",[e._v(e._s(e.$t("menu.add_to_readlist")))])])],1),e.isAdmin&&"books"===e.kind?t(i.A,{attrs:{icon:""},on:{click:e.bulkEdit}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-table-edit")])]}}],null,!1,2794987148)},[t("span",[e._v(e._s(e.$t("menu.bulk_edit_metadata")))])])],1):e._e(),!e.isAdmin||"books"!==e.kind&&"series"!==e.kind?e._e():t(i.A,{attrs:{icon:""},on:{click:e.edit}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-pencil")])]}}],null,!1,1783139550)},[t("span",[e._v(e._s(e.$t("menu.edit_metadata")))])])],1),e.isAdmin?t(i.A,{attrs:{icon:""},on:{click:e.doDelete}},[t(r.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(o.A,e._g({},s),[e._v("mdi-delete")])]}}],null,!1,2967236346)},[t("span",[e._v(e._s(e.$t("menu.delete")))])])],1):e._e()],1):e._e()],1)},c=[],h=s(85471),u=s(72448),m=h.Ay.extend({name:"MultiSelectBar",components:{ToolbarSticky:u.A},data:()=>({}),props:{value:{type:Array,required:!0},kind:{type:String,required:!0},oneshots:{type:Boolean,default:!1},showSelectAll:{type:Boolean,default:!1}},computed:{isAdmin(){return this.$store.getters.meAdmin}},methods:{unselectAll(){this.$emit("unselect-all")},selectAll(){this.$emit("select-all")},markRead(){this.$emit("mark-read")},markUnread(){this.$emit("mark-unread")},addToCollection(){this.$emit("add-to-collection")},addToReadList(){this.$emit("add-to-readlist")},edit(){this.$emit("edit")},bulkEdit(){this.$emit("bulk-edit")},doDelete(){this.$emit("delete")}}}),p=m,f=s(81656),g=(0,f.A)(p,d,c,!1,null,null,null),v=g.exports},4029:function(e,t,s){s.r(t),s.d(t,{default:function(){return y}});var i=s(70793),o=s(26702),n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",[e.showToolbar?t("toolbar-sticky",[t(o.sw,[t("span",[e._v(e._s(e.$t("search.search_results_for",{name:e.$route.query.q})))])])],1):e._e(),t("multi-select-bar",{attrs:{kind:"series"},on:{"unselect-all":function(t){e.selectedSeries=[]},"mark-read":e.markSelectedSeriesRead,"mark-unread":e.markSelectedSeriesUnread,"add-to-collection":e.addToCollection,"add-to-readlist":e.addSeriesBooksToReadList,edit:e.editMultipleSeries,delete:e.deleteSeries},model:{value:e.selectedSeries,callback:function(t){e.selectedSeries=t},expression:"selectedSeries"}}),t("multi-select-bar",{attrs:{kind:"books",oneshots:e.selectedOneshots},on:{"unselect-all":function(t){e.selectedBooks=[]},"mark-read":e.markSelectedBooksRead,"mark-unread":e.markSelectedBooksUnread,"add-to-readlist":e.addToReadList,"add-to-collection":e.addOneshotsToCollection,edit:e.editMultipleBooks,"bulk-edit":e.bulkEditMultipleBooks,delete:e.deleteBooks},model:{value:e.selectedBooks,callback:function(t){e.selectedBooks=t},expression:"selectedBooks"}}),t("multi-select-bar",{attrs:{kind:"collections"},on:{"unselect-all":function(t){e.selectedCollections=[]},delete:e.deleteCollections},model:{value:e.selectedCollections,callback:function(t){e.selectedCollections=t},expression:"selectedCollections"}}),t("multi-select-bar",{attrs:{kind:"readlists"},on:{"unselect-all":function(t){e.selectedReadLists=[]},delete:e.deleteReadLists},model:{value:e.selectedReadLists,callback:function(t){e.selectedReadLists=t},expression:"selectedReadLists"}}),t(i.A,{attrs:{fluid:""}},[e.emptyResults?t("empty-state",{staticClass:"my-4",attrs:{title:e.$t("search.no_results"),"sub-title":e.$t("search.search_for_something_else"),icon:"mdi-magnify","icon-color":"secondary"}}):[e.loaderSeries&&0!==e.loaderSeries.items.length?t("horizontal-scroller",{staticClass:"mb-4",attrs:{tick:e.loaderSeries.tick},on:{"scroll-changed":t=>e.scrollChanged(e.loaderSeries,t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("div",{staticClass:"title"},[e._v(e._s(e.$tc("common.series",2)))])]},proxy:!0},{key:"content",fn:function(){return[t("item-browser",{attrs:{items:e.loaderSeries.items,nowrap:"","edit-function":e.isAdmin?e.singleEditSeries:void 0,selected:e.selectedSeries,selectable:0===e.selectedBooks.length&&0===e.selectedCollections.length&&0===e.selectedReadLists.length,"fixed-item-width":e.fixedCardWidth},on:{"update:selected":function(t){e.selectedSeries=t}}})]},proxy:!0}],null,!1,2528792884)}):e._e(),e.loaderBooks&&0!==e.loaderBooks.items.length?t("horizontal-scroller",{staticClass:"mb-4",attrs:{tick:e.loaderBooks.tick},on:{"scroll-changed":t=>e.scrollChanged(e.loaderBooks,t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("div",{staticClass:"title"},[e._v(e._s(e.$t("common.books")))])]},proxy:!0},{key:"content",fn:function(){return[t("item-browser",{attrs:{items:e.loaderBooks.items,"item-context":[e.ItemContext.SHOW_SERIES],nowrap:"","edit-function":e.isAdmin?e.singleEditBook:void 0,selected:e.selectedBooks,selectable:0===e.selectedSeries.length&&0===e.selectedCollections.length&&0===e.selectedReadLists.length,"fixed-item-width":e.fixedCardWidth},on:{"update:selected":function(t){e.selectedBooks=t}}})]},proxy:!0}],null,!1,2389721006)}):e._e(),e.loaderCollections&&0!==e.loaderCollections.items.length?t("horizontal-scroller",{staticClass:"mb-4",attrs:{tick:e.loaderCollections.tick},on:{"scroll-changed":t=>e.scrollChanged(e.loaderCollections,t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("div",{staticClass:"title"},[e._v(e._s(e.$t("common.collections")))])]},proxy:!0},{key:"content",fn:function(){return[t("item-browser",{attrs:{items:e.loaderCollections.items,nowrap:"","edit-function":e.isAdmin?e.singleEditCollection:void 0,selected:e.selectedCollections,selectable:e.isAdmin&&0===e.selectedSeries.length&&0===e.selectedBooks.length&&0===e.selectedReadLists.length,"fixed-item-width":e.fixedCardWidth},on:{"update:selected":function(t){e.selectedCollections=t}}})]},proxy:!0}],null,!1,2252711023)}):e._e(),e.loaderReadLists&&0!==e.loaderReadLists.items.length?t("horizontal-scroller",{staticClass:"mb-4",attrs:{tick:e.loaderReadLists.tick},on:{"scroll-changed":t=>e.scrollChanged(e.loaderReadLists,t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[t("div",{staticClass:"title"},[e._v(e._s(e.$t("common.readlists")))])]},proxy:!0},{key:"content",fn:function(){return[t("item-browser",{attrs:{items:e.loaderReadLists.items,nowrap:"","edit-function":e.isAdmin?e.singleEditReadList:void 0,selected:e.selectedReadLists,selectable:e.isAdmin&&0===e.selectedSeries.length&&0===e.selectedBooks.length&&0===e.selectedCollections.length,"fixed-item-width":e.fixedCardWidth},on:{"update:selected":function(t){e.selectedReadLists=t}}})]},proxy:!0}],null,!1,1128922959)}):e._e()]],2)],1)},l=[],a=(s(14602),s(78892)),r=s(72448),d=s(1324),c=s(81301),h=s(10734),u=s(52846),m=s(85471),p=s(2543),f=s(30415),g=s(54919),v=s(19447),k=m.Ay.extend({name:"SearchView",components:{EmptyState:d.A,ToolbarSticky:r.A,HorizontalScroller:c.A,ItemBrowser:h.A,MultiSelectBar:a.A},data:()=>({ItemContext:g.XZ,loaderSeries:void 0,loaderBooks:void 0,loaderCollections:void 0,loaderReadLists:void 0,pageSize:20,loading:!1,selectedSeries:[],selectedBooks:[],selectedCollections:[],selectedReadLists:[]}),created(){this.$eventHub.$on(u.yn,this.reloadResults),this.$eventHub.$on(u.P,this.seriesChanged),this.$eventHub.$on(u.Mi,this.seriesChanged),this.$eventHub.$on(u.vk,this.bookChanged),this.$eventHub.$on(u.Qg,this.bookChanged),this.$eventHub.$on(u.Gx,this.collectionChanged),this.$eventHub.$on(u.HS,this.collectionChanged),this.$eventHub.$on(u._X,this.readListChanged),this.$eventHub.$on(u.Vp,this.readListChanged),this.$eventHub.$on(u.pU,this.readProgressChanged),this.$eventHub.$on(u.Ih,this.readProgressChanged),this.$eventHub.$on(u.$V,this.readProgressSeriesChanged),this.$eventHub.$on(u.sn,this.readProgressSeriesChanged)},beforeDestroy(){this.$eventHub.$off(u.yn,this.reloadResults),this.$eventHub.$off(u.P,this.seriesChanged),this.$eventHub.$off(u.Mi,this.seriesChanged),this.$eventHub.$off(u.vk,this.bookChanged),this.$eventHub.$off(u.Qg,this.bookChanged),this.$eventHub.$off(u.Gx,this.collectionChanged),this.$eventHub.$off(u.HS,this.collectionChanged),this.$eventHub.$off(u._X,this.readListChanged),this.$eventHub.$off(u.Vp,this.readListChanged),this.$eventHub.$off(u.pU,this.readProgressChanged),this.$eventHub.$off(u.Ih,this.readProgressChanged),this.$eventHub.$off(u.$V,this.readProgressSeriesChanged),this.$eventHub.$off(u.sn,this.readProgressSeriesChanged)},watch:{"$route.query.q":{handler:function(e){this.setupLoaders(e),this.loadResults(e),this.selectedBooks=[],this.selectedSeries=[],this.selectedCollections=[],this.selectedReadLists=[]},deep:!0,immediate:!0}},computed:{isAdmin(){return this.$store.getters.meAdmin},fixedCardWidth(){return this.$vuetify.breakpoint.xs?120:150},showToolbar(){return 0===this.selectedSeries.length&&0===this.selectedBooks.length&&0===this.selectedCollections.length&&0===this.selectedReadLists.length},emptyResults(){var e,t,s,i;return!this.loading&&0===(null===(e=this.loaderSeries)||void 0===e?void 0:e.items.length)&&0===(null===(t=this.loaderBooks)||void 0===t?void 0:t.items.length)&&0===(null===(s=this.loaderCollections)||void 0===s?void 0:s.items.length)&&0===(null===(i=this.loaderReadLists)||void 0===i?void 0:i.items.length)},selectedOneshots(){return this.selectedBooks.every((e=>e.oneshot))}},methods:{async scrollChanged(e,t){t>.95&&await e.loadNext()},seriesChanged(e){var t;null!==(t=this.loaderSeries)&&void 0!==t&&t.items.some((t=>t.id===e.seriesId))&&this.reloadResults()},bookChanged(e){var t;null!==(t=this.loaderBooks)&&void 0!==t&&t.items.some((t=>t.id===e.bookId))&&this.reloadResults()},readProgressChanged(e){var t;null!==(t=this.loaderBooks)&&void 0!==t&&t.items.some((t=>t.id===e.bookId))&&this.reloadResults()},readProgressSeriesChanged(e){var t;null!==(t=this.loaderSeries)&&void 0!==t&&t.items.some((t=>t.id===e.seriesId))&&this.reloadResults()},collectionChanged(e){var t;null!==(t=this.loaderCollections)&&void 0!==t&&t.items.some((t=>t.id===e.collectionId))&&this.reloadResults()},readListChanged(e){var t;null!==(t=this.loaderReadLists)&&void 0!==t&&t.items.some((t=>t.id===e.readListId))&&this.reloadResults()},async singleEditSeries(e){if(e.oneshot){const t=(await this.$komgaBooks.getBooksList({condition:new v.kq(new v.Tr(e.id))})).content[0];this.$store.dispatch("dialogUpdateOneshots",{series:e,book:t})}else this.$store.dispatch("dialogUpdateSeries",e)},async singleEditBook(e){if(e.oneshot){const t=await this.$komgaSeries.getOneSeries(e.seriesId);this.$store.dispatch("dialogUpdateOneshots",{series:t,book:e})}else this.$store.dispatch("dialogUpdateBooks",e)},singleEditCollection(e){this.$store.dispatch("dialogEditCollection",e)},singleEditReadList(e){this.$store.dispatch("dialogEditReadList",e)},async markSelectedSeriesRead(){await Promise.all(this.selectedSeries.map((e=>this.$komgaSeries.markAsRead(e.id)))),this.selectedSeries=await Promise.all(this.selectedSeries.map((e=>this.$komgaSeries.getOneSeries(e.id))))},async markSelectedSeriesUnread(){await Promise.all(this.selectedSeries.map((e=>this.$komgaSeries.markAsUnread(e.id)))),this.selectedSeries=await Promise.all(this.selectedSeries.map((e=>this.$komgaSeries.getOneSeries(e.id))))},addToCollection(){this.$store.dispatch("dialogAddSeriesToCollection",this.selectedSeries.map((e=>e.id)))},addToReadList(){this.$store.dispatch("dialogAddBooksToReadList",this.selectedBooks.map((e=>e.id)))},async addSeriesBooksToReadList(){const e=this.selectedSeries.map((e=>new v.kq(new v.Tr(e.id)))),t=await this.$komgaBooks.getBooksList({condition:new v.a4(e)},{unpaged:!0});this.$store.dispatch("dialogAddBooksToReadList",t.content.map((e=>e.id)))},addOneshotsToCollection(){this.$store.dispatch("dialogAddSeriesToCollection",this.selectedBooks.map((e=>e.seriesId)))},async editMultipleSeries(){if(this.selectedSeries.every((e=>e.oneshot))){const e=await Promise.all(this.selectedSeries.map((e=>this.$komgaBooks.getBooksList({condition:new v.kq(new v.Tr(e.id))})))),t=this.selectedSeries.map(((t,s)=>({series:t,book:e[s].content[0]})));this.$store.dispatch("dialogUpdateOneshots",t)}else this.$store.dispatch("dialogUpdateSeries",this.selectedSeries)},async editMultipleBooks(){if(this.selectedBooks.every((e=>e.oneshot))){const e=await Promise.all(this.selectedBooks.map((e=>this.$komgaSeries.getOneSeries(e.seriesId)))),t=this.selectedBooks.map(((t,s)=>({series:e[s],book:t})));this.$store.dispatch("dialogUpdateOneshots",t)}else this.$store.dispatch("dialogUpdateBooks",this.selectedBooks)},bulkEditMultipleBooks(){this.$store.dispatch("dialogUpdateBulkBooks",this.selectedBooks)},deleteSeries(){this.$store.dispatch("dialogDeleteSeries",this.selectedSeries)},deleteBooks(){this.$store.dispatch("dialogDeleteBook",this.selectedBooks)},deleteCollections(){this.$store.dispatch("dialogDeleteCollection",this.selectedCollections)},deleteReadLists(){this.$store.dispatch("dialogDeleteReadList",this.selectedReadLists)},async markSelectedBooksRead(){await Promise.all(this.selectedBooks.map((e=>this.$komgaBooks.updateReadProgress(e.id,{completed:!0}))))},async markSelectedBooksUnread(){await Promise.all(this.selectedBooks.map((e=>this.$komgaBooks.deleteReadProgress(e.id))))},reloadResults:(0,p.throttle)((function(){this.loadResults(this.$route.query.q.toString(),!0)}),500),setupLoaders(e){e?(this.loaderSeries=new f.D({size:this.pageSize},(t=>this.$komgaSeries.getSeriesList({fullTextSearch:e,condition:new v.WL(new v.ch)},t))),this.loaderBooks=new f.D({size:this.pageSize},(t=>this.$komgaBooks.getBooksList({fullTextSearch:e},t))),this.loaderCollections=new f.D({size:this.pageSize},(t=>this.$komgaCollections.getCollections(void 0,t,e))),this.loaderReadLists=new f.D({size:this.pageSize},(t=>this.$komgaReadLists.getReadLists(void 0,t,e)))):(this.loaderSeries=null,this.loaderBooks=null,this.loaderCollections=null,this.loaderReadLists=null)},async loadResults(e,t=!1){this.selectedBooks=[],this.selectedSeries=[],this.selectedCollections=[],this.selectedReadLists=[],e&&(this.loading=!0,t?Promise.all([this.loaderSeries.reload(),this.loaderBooks.reload(),this.loaderCollections.reload(),this.loaderReadLists.reload()]).then((()=>{this.loading=!1})):Promise.all([this.loaderSeries.loadNext(),this.loaderBooks.loadNext(),this.loaderCollections.loadNext(),this.loaderReadLists.loadNext()]).then((()=>{this.loading=!1})))}}}),b=k,S=s(81656),_=(0,S.A)(b,n,l,!1,null,"5c222adc",null),y=_.exports},30415:function(e,t,s){s.d(t,{D:function(){return o}});var i=s(32362);s(14602),s(28743);class o{get hasNextPage(){return!!this.currentPage&&!this.currentPage.last}get tick(){return this._tick}get hasLoadedAny(){return this.currentPage}constructor(e,t,s=e=>e){(0,i.A)(this,"pageable",void 0),(0,i.A)(this,"loader",void 0),(0,i.A)(this,"postProcessor",void 0),(0,i.A)(this,"currentPage",void 0),(0,i.A)(this,"loadedPages",[]),(0,i.A)(this,"_tick",0),(0,i.A)(this,"items",[]),this.pageable=e,this.loader=t,this.postProcessor=s}async reload(){if(!this.currentPage)return this.loadNext();const e=Object.assign({},this.pageable,{size:(this.currentPage.number+1)*(this.pageable.size||20),page:0}),t=await this.loader(e);this.items.splice(0,this.items.length,...t.content.map(this.postProcessor)),this._tick++}async loadNext(){if(this.currentPage){if(this.currentPage.last)return!1;{const e=this.currentPage.number+1;if(!this.loadedPages.includes(e)){this.loadedPages.push(e);const t=Object.assign({},this.pageable,{page:e});return this.currentPage=await this.loader(t),this.items.push(...this.currentPage.content.map(this.postProcessor)),this._tick++,!0}return!1}}return this.loadedPages.push(this.pageable.page||0),this.currentPage=await this.loader(this.pageable),this.items.push(...this.currentPage.content.map(this.postProcessor)),this._tick++,!0}}},22369:function(e,t,s){s(40125);var i=s(85471),o=s(20910),n=s(69463);const l=["sm","md","lg","xl"],a=["start","end","center"];function r(e,t){return l.reduce(((s,i)=>(s[e+(0,n.Zb)(i)]=t(),s)),{})}const d=e=>[...a,"baseline","stretch"].includes(e),c=r("align",(()=>({type:String,default:null,validator:d}))),h=e=>[...a,"space-between","space-around"].includes(e),u=r("justify",(()=>({type:String,default:null,validator:h}))),m=e=>[...a,"space-between","space-around","stretch"].includes(e),p=r("alignContent",(()=>({type:String,default:null,validator:m}))),f={align:Object.keys(c),justify:Object.keys(u),alignContent:Object.keys(p)},g={align:"align",justify:"justify",alignContent:"align-content"};function v(e,t,s){let i=g[e];if(null!=s){if(t){const s=t.replace(e,"");i+=`-${s}`}return i+=`-${s}`,i.toLowerCase()}}const k=new Map;t.A=i.Ay.extend({name:"v-row",functional:!0,props:{tag:{type:String,default:"div"},dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:d},...c,justify:{type:String,default:null,validator:h},...u,alignContent:{type:String,default:null,validator:m},...p},render(e,{props:t,data:s,children:i}){let n="";for(const o in t)n+=String(t[o]);let l=k.get(n);if(!l){let e;for(e in l=[],f)f[e].forEach((s=>{const i=t[s],o=v(e,s,i);o&&l.push(o)}));l.push({"no-gutters":t.noGutters,"row--dense":t.dense,[`align-${t.align}`]:t.align,[`justify-${t.justify}`]:t.justify,[`align-content-${t.alignContent}`]:t.alignContent}),k.set(n,l)}return e(t.tag,(0,o.Ay)(s,{staticClass:"row",class:l}),i)}})},30376:function(e,t,s){s.d(t,{A:function(){return k}});var i=s(28071),o=s(41769),n=s(34236),l=s(28492),a=s(48598),r=s(69227),d=s(26863),c=s(81582),h=s(56809),u=s(8177),m=s(72006),p=s(73803),f=s(69463),g=s(18857);const v=(0,m.A)(l.A,n.A,r.A,d.A,c.A,a.A);var k=v.extend({name:"v-menu",directives:{ClickOutside:h.A,Resize:u.A},provide(){return{isInMenu:!0,theme:this.theme}},props:{auto:Boolean,closeOnClick:{type:Boolean,default:!0},closeOnContentClick:{type:Boolean,default:!0},disabled:Boolean,disableKeys:Boolean,maxHeight:{type:[Number,String],default:"auto"},offsetX:Boolean,offsetY:Boolean,openOnHover:Boolean,origin:{type:String,default:"top left"},transition:{type:[Boolean,String],default:"v-menu-transition"},contentProps:{type:Object,default:()=>({})}},data(){return{calculatedTopAuto:0,defaultOffset:8,hasJustFocused:!1,listIndex:-1,resizeTimeout:0,selectedIndex:null,tiles:[]}},computed:{activeTile(){return this.tiles[this.listIndex]},calculatedLeft(){const e=Math.max(this.dimensions.content.width,parseFloat(this.calculatedMinWidth));return this.auto?(0,f.Dg)(this.calcXOverflow(this.calcLeftAuto(),e))||"0":this.calcLeft(e)||"0"},calculatedMaxHeight(){const e=this.auto?"200px":(0,f.Dg)(this.maxHeight);return e||"0"},calculatedMaxWidth(){return(0,f.Dg)(this.maxWidth)||"0"},calculatedMinWidth(){if(this.minWidth)return(0,f.Dg)(this.minWidth)||"0";const e=Math.min(this.dimensions.activator.width+Number(this.nudgeWidth)+(this.auto?16:0),Math.max(this.pageWidth-24,0)),t=isNaN(parseInt(this.calculatedMaxWidth))?e:parseInt(this.calculatedMaxWidth);return(0,f.Dg)(Math.min(t,e))||"0"},calculatedTop(){const e=this.auto?(0,f.Dg)(this.calcYOverflow(this.calculatedTopAuto)):this.calcTop();return e||"0"},hasClickableTiles(){return Boolean(this.tiles.find((e=>e.tabIndex>-1)))},styles(){return{maxHeight:this.calculatedMaxHeight,minWidth:this.calculatedMinWidth,maxWidth:this.calculatedMaxWidth,top:this.calculatedTop,left:this.calculatedLeft,transformOrigin:this.origin,zIndex:this.zIndex||this.activeZIndex}}},watch:{isActive(e){e||(this.listIndex=-1)},isContentActive(e){this.hasJustFocused=e},listIndex(e,t){if(e in this.tiles){const t=this.tiles[e];t.classList.add("v-list-item--highlighted");const s=this.$refs.content.scrollTop,i=this.$refs.content.clientHeight;s>t.offsetTop-8?(0,g.A)(t.offsetTop-t.clientHeight,{appOffset:!1,duration:300,container:this.$refs.content}):s+i<t.offsetTop+t.clientHeight+8&&(0,g.A)(t.offsetTop-i+2*t.clientHeight,{appOffset:!1,duration:300,container:this.$refs.content})}t in this.tiles&&this.tiles[t].classList.remove("v-list-item--highlighted")}},created(){this.$attrs.hasOwnProperty("full-width")&&(0,p.rq)("full-width",this)},mounted(){this.isActive&&this.callActivate()},methods:{activate(){this.updateDimensions(),requestAnimationFrame((()=>{this.startTransition().then((()=>{this.$refs.content&&(this.calculatedTopAuto=this.calcTopAuto(),this.auto&&(this.$refs.content.scrollTop=this.calcScrollPosition()))}))}))},calcScrollPosition(){const e=this.$refs.content,t=e.querySelector(".v-list-item--active"),s=e.scrollHeight-e.offsetHeight;return t?Math.min(s,Math.max(0,t.offsetTop-e.offsetHeight/2+t.offsetHeight/2)):e.scrollTop},calcLeftAuto(){return parseInt(this.dimensions.activator.left-2*this.defaultOffset)},calcTopAuto(){const e=this.$refs.content,t=e.querySelector(".v-list-item--active");if(t||(this.selectedIndex=null),this.offsetY||!t)return this.computedTop;this.selectedIndex=Array.from(this.tiles).indexOf(t);const s=t.offsetTop-this.calcScrollPosition(),i=e.querySelector(".v-list-item").offsetTop;return this.computedTop-s-i-1},changeListIndex(e){if(this.getTiles(),this.isActive&&this.hasClickableTiles)if(e.keyCode!==f.uP.tab){if(e.keyCode===f.uP.down)this.nextTile();else if(e.keyCode===f.uP.up)this.prevTile();else if(e.keyCode===f.uP.end)this.lastTile();else if(e.keyCode===f.uP.home)this.firstTile();else{if(e.keyCode!==f.uP.enter||-1===this.listIndex)return;this.tiles[this.listIndex].click()}e.preventDefault()}else this.isActive=!1},closeConditional(e){const t=e.target;return this.isActive&&!this._isDestroyed&&this.closeOnClick&&!this.$refs.content.contains(t)},genActivatorAttributes(){const e=o.A.options.methods.genActivatorAttributes.call(this);return this.activeTile&&this.activeTile.id?{...e,"aria-activedescendant":this.activeTile.id}:e},genActivatorListeners(){const e=a.A.options.methods.genActivatorListeners.call(this);return this.disableKeys||(e.keydown=this.onKeyDown),e},genTransition(){const e=this.genContent();return this.transition?this.$createElement("transition",{props:{name:this.transition}},[e]):e},genDirectives(){const e=[{name:"show",value:this.isContentActive}];return!this.openOnHover&&this.closeOnClick&&e.push({name:"click-outside",value:{handler:()=>{this.isActive=!1},closeConditional:this.closeConditional,include:()=>[this.$el,...this.getOpenDependentElements()]}}),e},genContent(){const e={attrs:{...this.getScopeIdAttrs(),...this.contentProps,role:"role"in this.$attrs?this.$attrs.role:"menu"},staticClass:"v-menu__content",class:{...this.rootThemeClasses,...this.roundedClasses,"v-menu__content--auto":this.auto,"v-menu__content--fixed":this.activatorFixed,menuable__content__active:this.isActive,[this.contentClass.trim()]:!0},style:this.styles,directives:this.genDirectives(),ref:"content",on:{click:e=>{const t=e.target;t.getAttribute("disabled")||this.closeOnContentClick&&(this.isActive=!1)},keydown:this.onKeyDown}};return this.$listeners.scroll&&(e.on=e.on||{},e.on.scroll=this.$listeners.scroll),!this.disabled&&this.openOnHover&&(e.on=e.on||{},e.on.mouseenter=this.mouseEnterHandler),this.openOnHover&&(e.on=e.on||{},e.on.mouseleave=this.mouseLeaveHandler),this.$createElement("div",e,this.getContentSlot())},getTiles(){this.$refs.content&&(this.tiles=Array.from(this.$refs.content.querySelectorAll(".v-list-item, .v-divider, .v-subheader")))},mouseEnterHandler(){this.runDelay("open",(()=>{this.hasJustFocused||(this.hasJustFocused=!0)}))},mouseLeaveHandler(e){this.runDelay("close",(()=>{var t;(null===(t=this.$refs.content)||void 0===t?void 0:t.contains(e.relatedTarget))||requestAnimationFrame((()=>{this.isActive=!1,this.callDeactivate()}))}))},nextTile(){const e=this.tiles[this.listIndex+1];if(!e){if(!this.tiles.length)return;return this.listIndex=-1,void this.nextTile()}this.listIndex++,-1===e.tabIndex&&this.nextTile()},prevTile(){const e=this.tiles[this.listIndex-1];if(!e){if(!this.tiles.length)return;return this.listIndex=this.tiles.length,void this.prevTile()}this.listIndex--,-1===e.tabIndex&&this.prevTile()},lastTile(){const e=this.tiles[this.tiles.length-1];e&&(this.listIndex=this.tiles.length-1,-1===e.tabIndex&&this.prevTile())},firstTile(){const e=this.tiles[0];e&&(this.listIndex=0,-1===e.tabIndex&&this.nextTile())},onKeyDown(e){if(!this.disableKeys){if(e.keyCode===f.uP.esc){setTimeout((()=>{this.isActive=!1}));const e=this.getActivator();this.$nextTick((()=>e&&e.focus()))}else!this.isActive&&[f.uP.up,f.uP.down].includes(e.keyCode)&&(this.isActive=!0);this.$nextTick((()=>this.changeListIndex(e)))}},onResize(){this.isActive&&(this.$refs.content.offsetWidth,this.updateDimensions(),clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(this.updateDimensions,100))}},render(e){const t={staticClass:"v-menu",class:{"v-menu--attached":""===this.attach||!0===this.attach||"attach"===this.attach},directives:[{arg:"500",name:"resize",value:this.onResize}]};return e("div",t,[!this.activator&&this.genActivator(),this.showLazyContent((()=>[this.$createElement(i.A,{props:{root:!0,light:this.light,dark:this.dark}},[this.genTransition()])]))])}})},26702:function(e,t,s){s.d(t,{MZ:function(){return l},sw:function(){return n}});var i=s(75704),o=s(69463);const n=(0,o.Gn)("v-toolbar__title"),l=(0,o.Gn)("v-toolbar__items");i.A}}]);
//# sourceMappingURL=search.a82326e1.js.map