"use strict";(self["webpackChunkkomga_webui"]=self["webpackChunkkomga_webui"]||[]).push([[2421],{94845:function(e,t,s){s.d(t,{A:function(){return v}});var i=s(58557),a=s(2115),r=s(21616),o=s(47452),l=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(o.A,{model:{value:e.collectionPanel,callback:function(t){e.collectionPanel=t},expression:"collectionPanel"}},e._l(e.collections,(function(s,o){return t(i.A,{key:o},[t(r.A,[e._v(e._s(e.$t("collections_expansion_panel.title",{name:s.name})))]),t(a.A,[t("horizontal-scroller",{attrs:{tick:e.collectionsLoaders[o].tick},on:{"scroll-changed":t=>e.scrollChanged(e.collectionsLoaders[o],t)},scopedSlots:e._u([{key:"prepend",fn:function(){return[e._t("prepend",null,{collection:s}),t("router-link",{staticClass:"text-overline",attrs:{to:{name:"browse-collection",params:{collectionId:s.id}}}},[e._v(e._s(e.$t("collections_expansion_panel.manage_collection"))+" ")])]},proxy:!0},{key:"content",fn:function(){return[t("item-browser",{attrs:{items:e.collectionsLoaders[o].items,nowrap:"",selectable:!1,"action-menu":!1,"fixed-item-width":100}})]},proxy:!0}],null,!0)})],1)],1)})),1)},n=[],c=s(81301),d=s(10734),u=s(85471),h=s(13044),m=s(30415),p=u.Ay.extend({name:"CollectionsExpansionPanels",components:{HorizontalScroller:c.A,ItemBrowser:d.A},props:{collections:{type:Array,required:!0}},data:()=>({collectionPanel:void 0,collectionsLoaders:[]}),watch:{collections:{handler(e){this.collectionPanel=void 0,this.collectionsLoaders=e.map((e=>new m.D({},(t=>this.$komgaCollections.getSeries(e.id,t)),(t=>(t.context={origin:h.E.COLLECTION,id:e.id},t)))))},immediate:!0},async collectionPanel(e){void 0!==e&&(this.collectionsLoaders[e].hasLoadedAny||this.collectionsLoaders[e].loadNext())}},methods:{async scrollChanged(e,t){t>.95&&await e.loadNext()}}}),f=p,g=s(81656),y=(0,g.A)(f,l,n,!1,null,null,null),v=y.exports},42715:function(e,t,s){s.d(t,{A:function(){return f}});var i=s(16684),a=s(18748),r=s(94026),o=s(45475),l=s(69791),n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(a.A,{attrs:{dense:""}},e._l(e.sortOptions,(function(s,a){return t(r.A,{key:a,on:{click:function(t){return e.setSort(s)}}},[t(o.A,[s.key===e.sortActive.key&&"asc"===e.sortActive.order?t(i.A,{attrs:{color:"secondary"}},[e._v(" mdi-chevron-up ")]):e._e(),s.key===e.sortActive.key&&"desc"===e.sortActive.order?t(i.A,{attrs:{color:"secondary"}},[e._v(" mdi-chevron-down ")]):e._e()],1),t(l.UZ,[e._v(e._s(s.name))])],1)})),1)},c=[],d=s(85471),u=d.Ay.extend({name:"SortList",props:{sortOptions:{type:Array,required:!0},sortDefault:{type:Object,required:!0},sortActive:{type:Object,required:!0}},methods:{setSort(e){this.sortActive.key===e.key&&"desc"===this.sortActive.order?this.$emit("update:sortActive",{key:e.key,order:"asc"}):this.$emit("update:sortActive",{key:e.key,order:"desc"})}}}),h=u,m=s(81656),p=(0,m.A)(h,n,c,!1,null,"24e7aee8",null),f=p.exports},4760:function(e,t,s){s.r(t),s.d(t,{default:function(){return K}});var i=s(73847),a=s(15137),r=s(1231),o=s(70793),l=s(39975),n=s(16684),c=s(6231),d=s(22369),u=s(40005),h=s(26702),m=s(84551),p=function(){var e=this,t=e._self._c;e._self._setupProxy;return e.$_.isEmpty(e.series)?e._e():t("div",[0===e.selectedBooks.length?t("toolbar-sticky",[t(m.A,{attrs:{bottom:"",disabled:!e.isAdmin},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t(i.A,e._g({attrs:{icon:"",to:e.parentLocation}},s),[t("rtl-icon",{attrs:{icon:"mdi-arrow-left",rtl:"mdi-arrow-right"}})],1)]}}],null,!1,2434228632)},[e.contextCollection?t("span",[e._v(e._s(e.$t("common.go_to_collection")))]):t("span",[e._v(e._s(e.$t("common.go_to_library")))])]),e.series?t("series-actions-menu",{attrs:{series:e.series}}):e._e(),t(h.sw,[e.$_.get(e.series,"metadata.title")?t("span",[e._v(e._s(e.series.metadata.title))]):e._e(),e.totalElements?t(a.A,{staticClass:"mx-4",attrs:{label:""}},[t("span",{staticStyle:{"font-size":"1.1rem"}},[e._v(e._s(e.totalElements))])]):e._e()],1),t(u.A),e.isAdmin?t(i.A,{attrs:{icon:""},on:{click:e.editSeries}},[t(n.A,[e._v("mdi-pencil")])],1):e._e(),t("page-size-select",{model:{value:e.pageSize,callback:function(t){e.pageSize=t},expression:"pageSize"}}),t(i.A,{attrs:{icon:""},on:{click:function(t){e.drawer=!e.drawer}}},[t(n.A,{attrs:{color:e.sortOrFilterActive?"secondary":""}},[e._v("mdi-filter-variant")])],1)],1):e._e(),t("multi-select-bar",{attrs:{kind:"books","show-select-all":""},on:{"unselect-all":function(t){e.selectedBooks=[]},"select-all":function(t){e.selectedBooks=e.books},"mark-read":e.markSelectedRead,"mark-unread":e.markSelectedUnread,"add-to-readlist":e.addToReadList,"bulk-edit":e.bulkEditMultipleBooks,edit:e.editMultipleBooks,delete:e.deleteBooks},model:{value:e.selectedBooks,callback:function(t){e.selectedBooks=t},expression:"selectedBooks"}}),t("filter-drawer",{attrs:{"clear-button":e.sortOrFilterActive},on:{clear:e.resetSortAndFilters},scopedSlots:e._u([{key:"default",fn:function(){return[t("filter-list",{attrs:{"filters-options":e.filterOptionsList,"filters-active":e.filters},on:{"update:filtersActive":function(t){e.filters=t},"update:filters-active":function(t){e.filters=t}}})]},proxy:!0},{key:"filter",fn:function(){return[t("filter-panels",{attrs:{"filters-options":e.filterOptionsPanel,"filters-active":e.filters,"filters-active-mode":e.filtersMode},on:{"update:filtersActive":function(t){e.filters=t},"update:filters-active":function(t){e.filters=t},"update:filtersActiveMode":function(t){e.filtersMode=t},"update:filters-active-mode":function(t){e.filtersMode=t}}})]},proxy:!0},{key:"sort",fn:function(){return[t("sort-list",{attrs:{"sort-default":e.sortDefault,"sort-options":e.sortOptions,"sort-active":e.sortActive},on:{"update:sortActive":function(t){e.sortActive=t},"update:sort-active":function(t){e.sortActive=t}}})]},proxy:!0}],null,!1,2332156884),model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}}),t(o.A,{staticClass:"pa-6",attrs:{fluid:""}},[t(d.A,[t(r.A,{attrs:{cols:"4",sm:"4",md:"auto",lg:"auto",xl:"auto"}},[e.series.hasOwnProperty("id")?t("item-card",{attrs:{width:"212",item:e.series,"thumbnail-only":"","no-link":"","action-menu":!1}}):e._e()],1),t(r.A,{attrs:{cols:"8"}},[t(o.A,[t(d.A,[t(r.A,{staticClass:"py-1"},[e.$_.get(e.series,"metadata.title")?t("span",{staticClass:"text-h5"},[e._v(e._s(e.series.metadata.title))]):e._e(),t("router-link",{staticClass:"caption link-underline",class:e.$vuetify.breakpoint.smAndUp?"mx-2":"",style:e.$vuetify.breakpoint.xsOnly?"display: block":"",attrs:{to:{name:"browse-libraries",params:{libraryId:e.series.libraryId}}}},[e._v(e._s(e.$t("searchbox.in_library",{library:e.getLibraryName(e.series)}))+" ")])],1)],1),e.series.booksMetadata.releaseDate?t(d.A,{staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-1"},[t(m.A,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t("span",e._g({},s),[e._v(e._s(new Intl.DateTimeFormat(e.$i18n.locale,{year:"numeric",timeZone:"UTC"}).format(new Date(e.series.booksMetadata.releaseDate))))])]}}],null,!1,667952866)},[e._v(" "+e._s(e.$t("browse_series.earliest_year_from_release_dates"))+" ")])],1)],1):e._e(),t(d.A,{staticClass:"text-body-2"},[t(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[t(a.A,{attrs:{label:"",small:"",link:"",color:e.statusChip.color,"text-color":e.statusChip.text,to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{status:[new e.SearchConditionSeriesStatus(new e.SearchOperatorIs(e.series.metadata.status))]}}}},[e._v(" "+e._s(e.$t(`enums.series_status.${e.series.metadata.status}`))+" ")])],1),e.series.metadata.ageRating?t(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[t(a.A,{attrs:{label:"",small:"",link:"",to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{ageRating:[new e.SearchConditionAgeRating(new e.SearchOperatorIs(e.series.metadata.ageRating.toString()))]}}}},[e._v(" "+e._s(e.series.metadata.ageRating)+"+ ")])],1):e._e(),e.series.metadata.language?t(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[t(a.A,{attrs:{label:"",small:"",link:"",to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{language:[new e.SearchConditionLanguage(new e.SearchOperatorIs(e.series.metadata.language))]}}}},[e._v(" "+e._s(e.languageDisplay)+" ")])],1):e._e(),e.series.metadata.readingDirection?t(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[t(a.A,{attrs:{label:"",small:""}},[e._v(" "+e._s(e.$t(`enums.reading_direction.${e.series.metadata.readingDirection}`))+" ")])],1):e._e(),e.unavailable?t(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[t(a.A,{attrs:{label:"",small:"",color:"error"}},[e._v(" "+e._s(e.$t("common.unavailable"))+" ")])],1):e._e()],1),t(d.A,{staticClass:"text-caption",attrs:{align:"center"}},[e.series.metadata.totalBookCount?t(r.A,{attrs:{cols:"auto"}},[e._v(" "+e._s(e.$t("common.books_total",{count:e.series.booksCount,total:e.series.metadata.totalBookCount}))+" ")]):t(r.A,{attrs:{cols:"auto"}},[e._v(" "+e._s(e.$tc("common.books_n",e.series.booksCount))+" ")])],1),e.$vuetify.breakpoint.smAndUp?[e.series.metadata.alternateTitles.length>0?t("read-more",{staticClass:"mb-4",attrs:{"i18n-less":"titles_more.less","i18n-more":"titles_more.more"},model:{value:e.readMoreTitles,callback:function(t){e.readMoreTitles=t},expression:"readMoreTitles"}},e._l(e.series.metadata.alternateTitles,(function(s,i){return t(d.A,{key:i,staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-0 text-uppercase",class:0===i?"pt-4":i===e.series.metadata.alternateTitles.length-1?"pb-4":"",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[e._v(" "+e._s(s.label)+" ")]),t(r.A,{staticClass:"py-0",class:0===i?"pt-4":i===e.series.metadata.alternateTitles.length-1?"pb-4":"",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[e._v(" "+e._s(s.title)+" ")])],1)})),1):e._e(),t(d.A,{staticClass:"align-center"},[t(r.A,{attrs:{cols:"auto"}},[t(i.A,{attrs:{title:e.$t("menu.download_series"),small:"",disabled:!e.canDownload,href:e.fileUrl}},[t(n.A,{attrs:{left:"",small:""}},[e._v("mdi-file-download")]),e._v(" "+e._s(e.$t("common.download"))+" ")],1)],1)],1),e.series.metadata.summary?t(d.A,[t(r.A,[t("read-more",{model:{value:e.readMore,callback:function(t){e.readMore=t},expression:"readMore"}},[e._v(e._s(e.series.metadata.summary))])],1)],1):e._e(),!e.series.metadata.summary&&e.series.booksMetadata.summary?t(d.A,[t(r.A,[t(m.A,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t("span",e._g({staticClass:"text-caption"},s),[e._v(" "+e._s(e.$t("browse_series.summary_from_book",{number:e.series.booksMetadata.summaryNumber}))+" ")])]}}],null,!1,2517282763)},[e._v(" "+e._s(e.$t("browse_series.series_no_summary"))+" ")]),t("read-more",{model:{value:e.readMore,callback:function(t){e.readMore=t},expression:"readMore"}},[e._v(e._s(e.series.booksMetadata.summary))])],1)],1):e._e()]:e._e()],2)],1)],1),e.$vuetify.breakpoint.xsOnly?[e.series.metadata.alternateTitles.length>0?t("read-more",{staticClass:"mb-4",attrs:{"i18n-less":"titles_more.less","i18n-more":"titles_more.more"},model:{value:e.readMoreTitles,callback:function(t){e.readMoreTitles=t},expression:"readMoreTitles"}},e._l(e.series.metadata.alternateTitles,(function(s,i){return t(d.A,{key:i,staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-0 text-uppercase",class:0===i?"pt-4":i===e.series.metadata.alternateTitles.length-1?"pb-4":"",attrs:{cols:"4"}},[e._v(e._s(s.label)+" ")]),t(r.A,{staticClass:"py-0",class:0===i?"pt-4":i===e.series.metadata.alternateTitles.length-1?"pb-4":"",attrs:{cols:"8"}},[e._v(e._s(s.title)+" ")])],1)})),1):e._e(),t(d.A,{staticClass:"align-center"},[t(r.A,{attrs:{cols:"auto"}},[t(i.A,{attrs:{title:e.$t("menu.download_series"),small:"",disabled:!e.canDownload,href:e.fileUrl}},[t(n.A,{attrs:{left:"",small:""}},[e._v("mdi-file-download")]),e._v(" "+e._s(e.$t("common.download"))+" ")],1)],1)],1),e.series.metadata.summary?t(d.A,[t(r.A,[t("read-more",{model:{value:e.readMore,callback:function(t){e.readMore=t},expression:"readMore"}},[e._v(e._s(e.series.metadata.summary))])],1)],1):e._e(),!e.series.metadata.summary&&e.series.booksMetadata.summary?t(d.A,[t(r.A,[t(m.A,{attrs:{right:""},scopedSlots:e._u([{key:"activator",fn:function({on:s}){return[t("span",e._g({staticClass:"text-caption"},s),[e._v(" "+e._s(e.$t("browse_series.summary_from_book",{number:e.series.booksMetadata.summaryNumber}))+" ")])]}}],null,!1,2517282763)},[e._v(" "+e._s(e.$t("browse_series.series_no_summary"))+" ")]),t("read-more",{model:{value:e.readMore,callback:function(t){e.readMore=t},expression:"readMore"}},[e._v(e._s(e.series.booksMetadata.summary))])],1)],1):e._e()]:e._e(),e.series.metadata.publisher?t(d.A,{staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[e._v(e._s(e.$t("common.publisher")))]),t(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t(a.A,{staticClass:"me-2",attrs:{title:e.series.metadata.publisher,to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{publisher:[new e.SearchConditionPublisher(new e.SearchOperatorIs(e.series.metadata.publisher))]}},label:"",small:"",outlined:"",link:""}},[e._v(e._s(e.series.metadata.publisher)+" ")])],1)],1):e._e(),e.series.metadata.genres.length>0?t(d.A,{staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[e._v(e._s(e.$t("common.genre")))]),t(r.A,{staticClass:"py-1 text-capitalize",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t("vue-horizontal",{scopedSlots:e._u([{key:"btn-prev",fn:function(){return[t(i.A,{attrs:{icon:"",small:""}},[t(n.A,[e._v("mdi-chevron-left")])],1)]},proxy:!0},{key:"btn-next",fn:function(){return[t(i.A,{attrs:{icon:"",small:""}},[t(n.A,[e._v("mdi-chevron-right")])],1)]},proxy:!0}],null,!1,187429412)},e._l(e.$_.sortBy(e.series.metadata.genres),(function(s,i){return t(a.A,{key:i,staticClass:"me-2",attrs:{title:s,to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{genre:[new e.SearchConditionGenre(new e.SearchOperatorIs(s))]}},label:"",small:"",outlined:"",link:""}},[e._v(e._s(s)+" ")])})),1)],1)],1):e._e(),e.series.metadata.tags.length>0||e.series.booksMetadata.tags.length>0?t(d.A,{staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[e._v(e._s(e.$t("common.tags")))]),t(r.A,{staticClass:"py-1 text-capitalize",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t("vue-horizontal",{scopedSlots:e._u([{key:"btn-prev",fn:function(){return[t(i.A,{attrs:{icon:"",small:""}},[t(n.A,[e._v("mdi-chevron-left")])],1)]},proxy:!0},{key:"btn-next",fn:function(){return[t(i.A,{attrs:{icon:"",small:""}},[t(n.A,[e._v("mdi-chevron-right")])],1)]},proxy:!0}],null,!1,187429412)},[e._l(e.$_.sortBy(e.series.metadata.tags),(function(s,i){return t(a.A,{key:`series_${i}`,staticClass:"me-2",attrs:{title:s,to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{tag:[new e.SearchConditionTag(new e.SearchOperatorIs(s))]}},label:"",small:"",outlined:"",link:""}},[e._v(e._s(s)+" ")])})),e._l(e.$_(e.series.booksMetadata.tags).difference(e.series.metadata.tags).sortBy(),(function(s,i){return t(a.A,{key:`book_${i}`,staticClass:"me-2",attrs:{title:s,to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{tag:[new e.SearchConditionTag(new e.SearchOperatorIs(s))]}},label:"",small:"",outlined:"",link:"",color:"contrast-light-2"}},[e._v(e._s(s)+" ")])}))],2)],1)],1):e._e(),e.series.metadata.links.length>0?t(d.A,{staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[e._v(e._s(e.$t("browse_book.links")))]),t(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},e._l(e.series.metadata.links,(function(s,i){return t(a.A,{key:i,staticClass:"me-2",attrs:{href:s.url,rel:"noreferrer",target:"_blank",label:"",small:"",outlined:"",link:""}},[e._v(" "+e._s(s.label)+" "),t(n.A,{staticClass:"ps-1",attrs:{"x-small":"",color:"grey"}},[e._v(" mdi-open-in-new ")])],1)})),1)],1):e._e(),e.series.booksMetadata.authors.length>0?t(l.A,{staticClass:"my-3"}):e._e(),e._l(e.displayedRoles,(function(s){return t(d.A,{key:s,staticClass:"align-center text-caption"},[t(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[e._v(e._s(e.$t(`author_roles.${s}`)))]),t(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t("vue-horizontal",{scopedSlots:e._u([{key:"btn-prev",fn:function(){return[t(i.A,{attrs:{icon:"",small:""}},[t(n.A,[e._v("mdi-chevron-left")])],1)]},proxy:!0},{key:"btn-next",fn:function(){return[t(i.A,{attrs:{icon:"",small:""}},[t(n.A,[e._v("mdi-chevron-right")])],1)]},proxy:!0}],null,!0)},e._l(e.authorsByRole[s].sort(),(function(i,r){return t(a.A,{key:r,staticClass:"me-2",attrs:{title:i,to:{name:"browse-libraries",params:{libraryId:e.series.libraryId},query:{[s]:[i]}},label:"",small:"",outlined:"",link:""}},[e._v(e._s(i)+" ")])})),1)],1)],1)})),t(d.A,[t(r.A,[t("collections-expansion-panels",{attrs:{collections:e.collections},scopedSlots:e._u([{key:"prepend",fn:function(s){return[t(m.A,{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function({on:a}){return[t(i.A,e._g({staticClass:"me-2",attrs:{icon:""},on:{click:function(t){return e.removeFromCollection(s.collection.id)}}},a),[t(n.A,[e._v("mdi-playlist-remove")])],1)]}}],null,!0)},[t("span",[e._v(e._s(e.$t("browse_series.remove_from_collection")))])])]}}],null,!1,1834926351)})],1)],1),t(l.A,{staticClass:"mt-4 mb-1"}),0===e.totalPages?t("empty-state",{attrs:{title:e.$t("common.filter_no_matches"),"sub-title":e.$t("common.use_filter_panel_to_change_filter"),icon:"mdi-book-multiple","icon-color":"secondary"}},[t(i.A,{on:{click:e.resetSortAndFilters}},[e._v(e._s(e.$t("common.reset_filters")))])],1):[e.totalPages>1?t(c.A,{attrs:{"total-visible":e.paginationVisible,length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}):e._e(),t("item-browser",{attrs:{items:e.books,"item-context":e.itemContext,selected:e.selectedBooks,"edit-function":e.isAdmin?e.editSingleBook:void 0},on:{"update:selected":function(t){e.selectedBooks=t}}}),e.totalPages>1?t(c.A,{attrs:{"total-visible":e.paginationVisible,length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}):e._e()]],2)],1)},f=[],g=(s(14602),s(28743),s(62554),s(78892)),y=s(72448),v=s(94845),_=s(1324),b=s(10734),A=s(82753),k=s(26562),$=s(4395),w=s(96982),S=s(33513),C=s(79957),x=s(52846),I=s(85471),O=s(41834),P=s(49865),E=s(85894),M=s(42715),B=s(71933),R=s(97782),D=s(75723),T=s(4291),L=s(41272),q=s(40889),N=s(24636),U=s(2543),z=s(54919),H=s(13044),F=s(19447),W=s(41728),Y=s(80061),G=s(86189);const J=s(1999);var Z=I.Ay.extend({name:"BrowseSeries",components:{ToolbarSticky:y.A,ItemBrowser:b.A,PageSizeSelect:$.A,SeriesActionsMenu:k.A,ItemCard:A.A,EmptyState:_.A,MultiSelectBar:g.A,CollectionsExpansionPanels:v.A,FilterDrawer:P.A,FilterList:E.A,FilterPanels:R.A,SortList:M.A,ReadMore:T.A,VueHorizontal:q.A,RtlIcon:N.A},data:function(){return{SearchConditionSeriesStatus:F.f$,SearchConditionPublisher:F.oy,SearchConditionGenre:F.BK,SearchConditionTag:F.iT,SearchConditionLanguage:F.oF,SearchConditionAgeRating:F.CM,SearchOperatorIs:F.Tr,series:{},context:{},books:[],selectedBooks:[],page:1,pageSize:20,totalPages:1,totalElements:null,sortActive:{},sortDefault:{key:"metadata.numberSort",order:"asc"},filters:{},filtersMode:{},sortUnwatch:null,filterUnwatch:null,filterModeUnwatch:null,pageUnwatch:null,pageSizeUnwatch:null,collections:[],drawer:!1,filterOptions:{tag:[],mediaProfile:[]},readMore:!1,readMoreTitles:!1}},computed:{itemContext(){return"metadata.releaseDate"===this.sortActive.key?[z.XZ.RELEASE_DATE]:"createdDate"===this.sortActive.key?[z.XZ.DATE_ADDED]:"fileSize"===this.sortActive.key?[z.XZ.FILE_SIZE]:[]},sortOptions(){return[{name:this.$t("sort.number").toString(),key:"metadata.numberSort"},{name:this.$t("sort.date_added").toString(),key:"createdDate"},{name:this.$t("sort.release_date").toString(),key:"metadata.releaseDate"},{name:this.$t("sort.file_size").toString(),key:"fileSize"},{name:this.$t("sort.file_name").toString(),key:"name"},{name:this.$t("sort.page_count").toString(),key:"media.pagesCount"}]},filterOptionsList(){return{readStatus:{values:[{name:this.$t("filter.unread").toString(),value:new F.qE(new F.Tr(C.RJ.UNREAD)),nValue:new F.qE(new F._f(C.RJ.UNREAD))},{name:this.$t("filter.in_progress").toString(),value:new F.qE(new F.Tr(C.RJ.IN_PROGRESS)),nValue:new F.qE(new F._f(C.RJ.IN_PROGRESS))},{name:this.$t("filter.read").toString(),value:new F.qE(new F.Tr(C.RJ.READ)),nValue:new F.qE(new F._f(C.RJ.READ))}]}}},filterOptionsPanel(){const e={tag:{name:this.$t("filter.tag").toString(),values:this.filterOptions.tag,anyAllSelector:!0},mediaProfile:{name:this.$t("filter.media_profile").toString(),values:Object.values(C.Er).map((e=>({name:Y.A.t(`enums.media_profile.${e}`),value:new F.H2(new F.Tr(e)),nValue:new F.H2(new F._f(e))})))}};return L.B.forEach((t=>{e[t]={name:this.$t(`author_roles.${t}`).toString(),search:async e=>(await this.$komgaReferential.getAuthors(e,t,void 0,void 0,this.seriesId)).content.map((e=>e.name)),values:[{name:this.$t("filter.any").toString(),value:G.M,nValue:G._}],anyAllSelector:!0}})),e},isAdmin(){return this.$store.getters.meAdmin},unavailable(){return this.series.deleted||this.$store.getters.getLibraryById(this.series.libraryId).unavailable},canDownload(){return this.$store.getters.meFileDownload&&!this.unavailable},fileUrl(){return(0,S.VX)(this.seriesId)},thumbnailUrl(){return(0,S.TJ)(this.seriesId)},paginationVisible(){switch(this.$vuetify.breakpoint.name){case"xs":return 5;case"sm":case"md":return 10;case"lg":case"xl":default:return 15}},languageDisplay(){var e;return(null===(e=J(this.series.metadata.language))||void 0===e||null===(e=e.language())||void 0===e?void 0:e.descriptions()[0])||this.series.metadata.language},statusChip(){switch(this.series.metadata.status){case O.m.ABANDONED:return{color:"red darken-4",text:"white"};case O.m.ENDED:return{color:"green darken-4",text:"white"};case O.m.HIATUS:return{color:"orange darken-4",text:"white"}}return{color:void 0,text:void 0}},sortOrFilterActive(){return(0,B.cJ)(this.sortActive,this.sortDefault,this.filters)},authorsByRole(){return(0,D.R)(this.series.booksMetadata.authors)},displayedRoles(){return L.u.filter((e=>this.authorsByRole[e]))},contextCollection(){return this.context.origin===H.E.COLLECTION},parentLocation(){return this.contextCollection?{name:"browse-collection",params:{collectionId:this.context.id}}:{name:"browse-libraries",params:{libraryId:this.series.libraryId}}}},props:{seriesId:{type:String,required:!0}},watch:{series(e){this.$_.has(e,"metadata.title")&&(document.title=`Komga - ${e.metadata.title}`)}},created(){this.$eventHub.$on(x.P,this.seriesChanged),this.$eventHub.$on(x.Mi,this.seriesDeleted),this.$eventHub.$on(x.R2,this.bookChanged),this.$eventHub.$on(x.vk,this.bookChanged),this.$eventHub.$on(x.Qg,this.bookChanged),this.$eventHub.$on(x.pU,this.readProgressChanged),this.$eventHub.$on(x.Ih,this.readProgressChanged),this.$eventHub.$on(x.yn,this.libraryDeleted),this.$eventHub.$on(x.Ep,this.collectionChanged),this.$eventHub.$on(x.Gx,this.collectionChanged),this.$eventHub.$on(x.HS,this.collectionChanged)},beforeDestroy(){this.$eventHub.$off(x.P,this.seriesChanged),this.$eventHub.$off(x.Mi,this.seriesDeleted),this.$eventHub.$off(x.R2,this.bookChanged),this.$eventHub.$off(x.vk,this.bookChanged),this.$eventHub.$off(x.Qg,this.bookChanged),this.$eventHub.$off(x.pU,this.readProgressChanged),this.$eventHub.$off(x.Ih,this.readProgressChanged),this.$eventHub.$off(x.yn,this.libraryDeleted),this.$eventHub.$off(x.Ep,this.collectionChanged),this.$eventHub.$off(x.Gx,this.collectionChanged),this.$eventHub.$off(x.HS,this.collectionChanged)},async mounted(){this.pageSize=this.$store.state.persistedState.browsingPageSize||this.pageSize,await this.resetParams(this.$route,this.seriesId),this.$route.query.page&&(this.page=Number(this.$route.query.page)),this.$route.query.pageSize&&(this.pageSize=Number(this.$route.query.pageSize)),this.loadSeries(this.seriesId),this.setWatches()},async beforeRouteUpdate(e,t,s){e.params.seriesId!==t.params.seriesId&&(this.unsetWatches(),await this.resetParams(e,e.params.seriesId),this.readMore=!1,this.readMoreTitles=!1,this.page=1,this.totalPages=1,this.totalElements=null,this.books=[],this.collections=[],this.loadSeries(e.params.seriesId),this.setWatches()),s()},methods:{getLibraryName(e){return this.$store.getters.getLibraryById(e.libraryId).name},resetSortAndFilters(){this.drawer=!1;for(const e in this.filters)this.$set(this.filters,e,[]);this.sortActive=this.sortDefault,this.updateRouteAndReload()},async resetParams(e,t){this.sortActive=this.parseQuerySortOrDefault(e.query.sort),this.$set(this.filterOptions,"tag",(0,B.Dr)(await this.$komgaReferential.getBookTags(t),(e=>new F.iT(new F.Tr(e))),(e=>new F.iT(new F._f(e)))));let s={};(e.query.readStatus||e.query.tag||e.query.mediaProfile||L.B.some((t=>t in e.query)))&&(s={readStatus:e.query.readStatus||[],tag:e.query.tag||[],mediaProfile:e.query.mediaProfile||[]},L.B.forEach((t=>{s[t]=e.query[t]||[]}))),this.filters=this.validateFilters(s);let i={};e.query.filterMode&&(i=e.query.filterMode),this.filtersMode=this.validateFiltersMode(i)},validateFilters(e){const t={readStatus:this.$_.intersectionWith(e.readStatus,(0,B.eW)(this.filterOptionsList.readStatus.values),W.Y)||[],tag:this.$_.intersectionWith(e.tag,(0,B.eW)(this.filterOptions.tag),W.Y)||[],mediaProfile:this.$_.intersectionWith(e.mediaProfile,(0,B.eW)(this.filterOptionsPanel.mediaProfile.values),W.Y)||[]};return L.B.forEach((s=>{t[s]=e[s]||[]})),t},validateFiltersMode(e){const t={};for(let s in e)"true"!=e[s].allOf&&1!=e[s].allOf||(t[s]={allOf:!0});return t},setWatches(){this.sortUnwatch=this.$watch("sortActive",this.updateRouteAndReload),this.filterUnwatch=this.$watch("filters",this.updateRouteAndReload),this.filterModeUnwatch=this.$watch("filtersMode",this.updateRouteAndReload),this.pageSizeUnwatch=this.$watch("pageSize",(e=>{this.$store.commit("setBrowsingPageSize",e),this.updateRouteAndReload()})),this.pageUnwatch=this.$watch("page",(e=>{this.updateRoute(),this.loadPage(this.seriesId,e,this.sortActive)}))},unsetWatches(){this.sortUnwatch(),this.filterUnwatch(),this.filterModeUnwatch(),this.pageUnwatch(),this.pageSizeUnwatch()},updateRouteAndReload(){this.unsetWatches(),this.page=1,this.updateRoute(),this.loadPage(this.seriesId,this.page,this.sortActive),this.setWatches()},libraryDeleted(e){e.libraryId===this.series.libraryId&&this.$router.push({name:"home"})},seriesChanged(e){e.seriesId===this.seriesId&&this.$komgaSeries.getOneSeries(this.seriesId).then((e=>this.series=e))},seriesDeleted(e){e.seriesId===this.seriesId&&this.$router.push({name:"browse-libraries",params:{libraryId:this.series.libraryId}})},bookChanged(e){e.seriesId===this.seriesId&&this.reloadPage()},readProgressChanged(e){this.books.some((t=>t.id===e.bookId))&&(this.reloadPage(),this.reloadSeries())},collectionChanged(e){(e.seriesIds.includes(this.seriesId)||this.collections.map((e=>e.id)).includes(e.collectionId))&&this.$komgaSeries.getCollections(this.seriesId).then((e=>this.collections=e))},reloadPage:(0,U.throttle)((function(){this.loadPage(this.seriesId,this.page,this.sortActive)}),1e3),reloadSeries:(0,U.throttle)((function(){this.$komgaSeries.getOneSeries(this.seriesId).then((e=>this.series=e))}),1e3),async loadSeries(e){this.$komgaSeries.getOneSeries(e).then((e=>{this.series=e,this.series.oneshot&&this.$router.replace({name:"browse-oneshot",params:{seriesId:this.seriesId}})})),this.$komgaSeries.getCollections(e).then((e=>this.collections=e)),this.$route.query.contextId&&this.$route.query.context&&Object.values(H.E).includes(this.$route.query.context)&&(this.context={origin:this.$route.query.context,id:this.$route.query.contextId},this.series.context=this.context),await this.loadPage(e,this.page,this.sortActive)},parseQuerySortOrDefault(e){return(0,w.k)(e,this.sortOptions)||this.$_.clone(this.sortDefault)},parseQueryFilterStatus(e){return e?e.toString().split(",").filter((e=>Object.keys(C.RJ).includes(e))):[]},updateRoute(){const e={name:this.$route.name,params:{seriesId:this.$route.params.seriesId},query:{page:`${this.page}`,pageSize:`${this.pageSize}`,sort:`${this.sortActive.key},${this.sortActive.order}`}};(0,B.Bp)(this.filters,e.query),e.query["filterMode"]=this.validateFiltersMode(this.filtersMode),this.$router.replace(e).catch((e=>{}))},async loadPage(e,t,s){var i,a;this.selectedBooks=[];const r={page:t-1,size:this.pageSize};s&&(r.sort=[`${s.key},${s.order}`]);const o=[];o.push(new F.kq(new F.Tr(e))),this.filters.readStatus&&this.filters.readStatus.length>0&&o.push(new F.a4(this.filters.readStatus)),this.filters.tag&&this.filters.tag.length>0&&(null!==(i=this.filtersMode)&&void 0!==i&&null!==(i=i.tag)&&void 0!==i&&i.allOf?o.push(new F.FY(this.filters.tag)):o.push(new F.a4(this.filters.tag))),this.filters.mediaProfile&&this.filters.mediaProfile.length>0&&(null!==(a=this.filtersMode)&&void 0!==a&&null!==(a=a.mediaProfile)&&void 0!==a&&a.allOf?o.push(new F.FY(this.filters.mediaProfile)):o.push(new F.a4(this.filters.mediaProfile))),L.B.forEach((e=>{if(e in this.filters){var t;const s=this.filters[e].map((t=>t===G.M?new F.$Z(new F.Tr({role:e})):t===G._?new F.$Z(new F._f({role:e})):new F.$Z(new F.Tr({name:t,role:e}))));o.push(null!==(t=this.filtersMode[e])&&void 0!==t&&t.allOf?new F.FY(s):new F.a4(s))}}));const l=await this.$komgaBooks.getBooksList({condition:new F.FY(o)},r);this.totalPages=l.totalPages,this.totalElements=l.totalElements,this.books=l.content},analyze(){this.$komgaSeries.analyzeSeries(this.series)},refreshMetadata(){this.$komgaSeries.refreshMetadata(this.series)},editSeries(){this.$store.dispatch("dialogUpdateSeries",this.series)},editSingleBook(e){this.$store.dispatch("dialogUpdateBooks",e)},editMultipleBooks(){this.$store.dispatch("dialogUpdateBooks",this.selectedBooks)},bulkEditMultipleBooks(){this.$store.dispatch("dialogUpdateBulkBooks",this.$_.sortBy(this.selectedBooks,["metadata.numberSort"]))},addToReadList(){this.$store.dispatch("dialogAddBooksToReadList",this.selectedBooks.map((e=>e.id)))},async markSelectedRead(){await Promise.all(this.selectedBooks.map((e=>this.$komgaBooks.updateReadProgress(e.id,{completed:!0})))),this.selectedBooks=[]},async markSelectedUnread(){await Promise.all(this.selectedBooks.map((e=>this.$komgaBooks.deleteReadProgress(e.id)))),this.selectedBooks=[]},deleteBooks(){this.$store.dispatch("dialogDeleteBook",this.selectedBooks)},removeFromCollection(e){const t=this.collections.find((t=>t.id==e)),s=Object.assign({},{seriesIds:null===t||void 0===t?void 0:t.seriesIds.filter((e=>e!=this.seriesId))});0==s.seriesIds.length?this.$komgaCollections.deleteCollection(t.id):this.$komgaCollections.patchCollection(t.id,s)}}}),V=Z,X=s(81656),j=(0,X.A)(V,p,f,!1,null,"0058acd4",null),K=j.exports},41728:function(e,t,s){s.d(t,{Y:function(){return i}});s(30959);function i(e,t){return JSON.stringify(e)===JSON.stringify(t)}},96982:function(e,t,s){s.d(t,{C:function(){return r},k:function(){return a}});s(68329);const i=["asc","desc"];function a(e,t){let s=null;if(e){const a=e.split(",");2===a.length&&t.map((e=>e.key)).includes(a[0])&&i.includes(a[1])&&(s={key:a[0],order:a[1]})}return s}function r(e){if(e&&0!==e.length)return"true"===e[0].trim().toLowerCase()||"false"!==e[0].trim().toLowerCase()&&void 0}},41834:function(e,t,s){s.d(t,{m:function(){return i},q:function(){return r}});var i,a=s(80061);function r(){return Object.values(i).map((e=>({name:a.A.t(`enums.series_status.${e}`),value:e})))}(function(e){e["ENDED"]="ENDED",e["ONGOING"]="ONGOING",e["ABANDONED"]="ABANDONED",e["HIATUS"]="HIATUS"})(i||(i={}))},86189:function(e,t,s){s.d(t,{M:function(){return i},_:function(){return a}});const i="KOMGA____ANY____",a="KOMGA____NONE____"},89233:function(e,t,s){var i=s(12071).PROPER,a=s(92074),r=s(55073),o="​᠎";e.exports=function(e){return a((function(){return!!r[e]()||o[e]()!==o||i&&r[e].name!==e}))}},69163:function(e,t,s){var i=s(30281),a=s(71229),r=s(95362),o=s(55073),l=i("".replace),n=RegExp("^["+o+"]+"),c=RegExp("(^|[^"+o+"])["+o+"]+$"),d=function(e){return function(t){var s=r(a(t));return 1&e&&(s=l(s,n,"")),2&e&&(s=l(s,c,"$1")),s}};e.exports={start:d(1),end:d(2),trim:d(3)}},55073:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},68329:function(e,t,s){var i=s(51605),a=s(69163).trim,r=s(89233);i({target:"String",proto:!0,forced:r("trim")},{trim:function(){return a(this)}})},90826:function(e,t,s){s.d(t,{A:function(){return l}});var i=s(32240),a=i.A,r=s(69463),o=s(85471),l=o.Ay.extend().extend({name:"overlayable",props:{hideOverlay:Boolean,overlayColor:String,overlayOpacity:[Number,String]},data(){return{animationFrame:0,overlay:null}},watch:{hideOverlay(e){this.isActive&&(e?this.removeOverlay():this.genOverlay())}},beforeDestroy(){this.removeOverlay()},methods:{createOverlay(){const e=new a({propsData:{absolute:this.absolute,value:!1,color:this.overlayColor,opacity:this.overlayOpacity}});e.$mount();const t=this.absolute?this.$el.parentNode:document.querySelector("[data-app]");t&&t.insertBefore(e.$el,t.firstChild),this.overlay=e},genOverlay(){if(this.hideScroll(),!this.hideOverlay)return this.overlay||this.createOverlay(),this.animationFrame=requestAnimationFrame((()=>{this.overlay&&(void 0!==this.activeZIndex?this.overlay.zIndex=String(this.activeZIndex-1):this.$el&&(this.overlay.zIndex=(0,r.fl)(this.$el)),this.overlay.value=!0)})),!0},removeOverlay(e=!0){this.overlay&&((0,r.d7)(this.overlay.$el,"transitionend",(()=>{this.overlay&&this.overlay.$el&&this.overlay.$el.parentNode&&!this.overlay.value&&!this.isActive&&(this.overlay.$el.parentNode.removeChild(this.overlay.$el),this.overlay.$destroy(),this.overlay=null)})),cancelAnimationFrame(this.animationFrame),this.overlay.value=!1),e&&this.showScroll()},scrollListener(e){if("key"in e){if(["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName)||e.target.isContentEditable)return;const t=[r.uP.up,r.uP.pageup],s=[r.uP.down,r.uP.pagedown];if(t.includes(e.keyCode))e.deltaY=-1;else{if(!s.includes(e.keyCode))return;e.deltaY=1}}(e.target===this.overlay||"keydown"!==e.type&&e.target===document.body||this.checkPath(e))&&e.preventDefault()},hasScrollbar(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return(["auto","scroll"].includes(t.overflowY)||"SELECT"===e.tagName)&&e.scrollHeight>e.clientHeight||["auto","scroll"].includes(t.overflowX)&&e.scrollWidth>e.clientWidth},shouldScroll(e,t){if(e.hasAttribute("data-app"))return!1;const s=t.shiftKey||t.deltaX?"x":"y",i="y"===s?t.deltaY:t.deltaX||t.deltaY;let a,r;"y"===s?(a=0===e.scrollTop,r=e.scrollTop+e.clientHeight===e.scrollHeight):(a=0===e.scrollLeft,r=e.scrollLeft+e.clientWidth===e.scrollWidth);const o=i<0,l=i>0;return!(a||!o)||(!(r||!l)||!(!a&&!r||!e.parentNode)&&this.shouldScroll(e.parentNode,t))},isInside(e,t){return e===t||null!==e&&e!==document.body&&this.isInside(e.parentNode,t)},checkPath(e){const t=(0,r.K9)(e);if("keydown"===e.type&&t[0]===document.body){const t=this.$refs.dialog,s=window.getSelection().anchorNode;return!(t&&this.hasScrollbar(t)&&this.isInside(s,t))||!this.shouldScroll(t,e)}for(let s=0;s<t.length;s++){const i=t[s];if(i===document)return!0;if(i===document.documentElement)return!0;if(i===this.$refs.content)return!0;if(this.hasScrollbar(i))return!this.shouldScroll(i,e)}return!0},hideScroll(){this.$vuetify.breakpoint.smAndDown?document.documentElement.classList.add("overflow-y-hidden"):((0,r.P4)(window,"wheel",this.scrollListener,{passive:!1}),window.addEventListener("keydown",this.scrollListener))},showScroll(){document.documentElement.classList.remove("overflow-y-hidden"),window.removeEventListener("wheel",this.scrollListener),window.removeEventListener("keydown",this.scrollListener)}}})}}]);
//# sourceMappingURL=browse-series.c64a4889.js.map