"use strict";(self["webpackChunkkomga_webui"]=self["webpackChunkkomga_webui"]||[]).push([[6730],{94845:function(t,e,s){s.d(e,{A:function(){return k}});var o=s(58557),i=s(2115),a=s(21616),r=s(47452),n=function(){var t=this,e=t._self._c;t._self._setupProxy;return e(r.A,{model:{value:t.collectionPanel,callback:function(e){t.collectionPanel=e},expression:"collectionPanel"}},t._l(t.collections,(function(s,r){return e(o.A,{key:r},[e(a.A,[t._v(t._s(t.$t("collections_expansion_panel.title",{name:s.name})))]),e(i.A,[e("horizontal-scroller",{attrs:{tick:t.collectionsLoaders[r].tick},on:{"scroll-changed":e=>t.scrollChanged(t.collectionsLoaders[r],e)},scopedSlots:t._u([{key:"prepend",fn:function(){return[t._t("prepend",null,{collection:s}),e("router-link",{staticClass:"text-overline",attrs:{to:{name:"browse-collection",params:{collectionId:s.id}}}},[t._v(t._s(t.$t("collections_expansion_panel.manage_collection"))+" ")])]},proxy:!0},{key:"content",fn:function(){return[e("item-browser",{attrs:{items:t.collectionsLoaders[r].items,nowrap:"",selectable:!1,"action-menu":!1,"fixed-item-width":100}})]},proxy:!0}],null,!0)})],1)],1)})),1)},l=[],d=s(81301),c=s(10734),m=s(85471),h=s(13044),b=s(30415),u=m.Ay.extend({name:"CollectionsExpansionPanels",components:{HorizontalScroller:d.A,ItemBrowser:c.A},props:{collections:{type:Array,required:!0}},data:()=>({collectionPanel:void 0,collectionsLoaders:[]}),watch:{collections:{handler(t){this.collectionPanel=void 0,this.collectionsLoaders=t.map((t=>new b.D({},(e=>this.$komgaCollections.getSeries(t.id,e)),(e=>(e.context={origin:h.E.COLLECTION,id:t.id},e)))))},immediate:!0},async collectionPanel(t){void 0!==t&&(this.collectionsLoaders[t].hasLoadedAny||this.collectionsLoaders[t].loadNext())}},methods:{async scrollChanged(t,e){e>.95&&await t.loadNext()}}}),_=u,g=s(81656),p=(0,g.A)(_,n,l,!1,null,null,null),k=p.exports},47541:function(t,e,s){s.r(e),s.d(e,{default:function(){return G}});var o=s(90623),i=s(73847),a=s(15137),r=s(1231),n=s(70793),l=s(16684),d=s(18748),c=s(94026),m=s(5291),h=s(69791),b=s(30376),u=s(22369),_=s(40005),g=s(84551),p=function(){var t=this,e=t._self._c;t._self._setupProxy;return t.$_.isEmpty(t.book)||t.$_.isEmpty(t.series)?t._e():e("div",[e("toolbar-sticky",[e(g.A,{attrs:{bottom:"",disabled:!t.isAdmin},scopedSlots:t._u([{key:"activator",fn:function({on:s}){return[e(i.A,t._g({attrs:{icon:"",to:t.parentLocation}},s),[e("rtl-icon",{attrs:{icon:"mdi-arrow-left",rtl:"mdi-arrow-right"}})],1)]}}],null,!1,2434228632)},[t.context.origin===t.ContextOrigin.READLIST?e("span",[t._v(t._s(t.$t("common.go_to_readlist")))]):t.context.origin===t.ContextOrigin.COLLECTION?e("span",[t._v(t._s(t.$t("common.go_to_collection")))]):e("span",[t._v(t._s(t.$t("common.go_to_library")))])]),t.book?e("oneshot-actions-menu",{attrs:{book:t.book,series:t.series}}):t._e(),t.isAdmin?e(i.A,{attrs:{icon:""},on:{click:t.editBook}},[e(l.A,[t._v("mdi-pencil")])],1):t._e(),e(_.A),t.context.origin===t.ContextOrigin.READLIST&&t.$vuetify.breakpoint.mdAndUp?e(o.A,{staticClass:"mb-0",attrs:{type:"info",text:"",dense:"",border:"right"}},[t._v(t._s(t.$t("browse_book.navigation_within_readlist",{name:t.contextName}))+" ")]):t._e(),t.context.origin===t.ContextOrigin.READLIST?e(i.A,{attrs:{icon:"",disabled:t.$_.isEmpty(t.siblingPrevious),to:{name:t.siblingPrevious.oneshot?"browse-oneshot":"browse-book",params:{seriesId:t.siblingPrevious.seriesId,bookId:t.previousId},query:{context:t.context.origin,contextId:t.context.id}}}},[e("rtl-icon",{attrs:{icon:"mdi-chevron-left",rtl:"mdi-chevron-right"}})],1):t._e(),t.context.origin===t.ContextOrigin.READLIST?e(b.A,{attrs:{bottom:"","offset-y":"","max-height":.7*t.$vuetify.breakpoint.height,"max-width":250},scopedSlots:t._u([{key:"activator",fn:function({on:s}){return[e(i.A,t._g({attrs:{icon:""}},s),[e(l.A,[t._v("mdi-menu")])],1)]}}],null,!1,3153626740)},[e(d.A,{attrs:{flat:""}},[e(m.A,{attrs:{color:"primary"}},t._l(t.siblings,(function(s,o){return e(c.A,{key:o,attrs:{to:{name:s.oneshot?"browse-oneshot":"browse-book",params:{seriesId:s.seriesId,bookId:s.id},query:{context:t.context.origin,contextId:t.context.id}}}},[e(h.UZ,{staticClass:"text-wrap text-body-2"},[t.context.origin!==t.ContextOrigin.READLIST||s.oneshot?t.context.origin===t.ContextOrigin.READLIST&&s.oneshot?[t._v(t._s(s.metadata.title)+" ")]:[t._v(t._s(s.metadata.number)+" - "+t._s(s.metadata.title))]:[t._v(t._s(s.seriesTitle)+" "+t._s(s.metadata.number)+": "+t._s(s.metadata.title)+" ")]],2)],1)})),1)],1)],1):t._e(),t.context.origin===t.ContextOrigin.READLIST?e(i.A,{attrs:{icon:"",disabled:t.$_.isEmpty(t.siblingNext),to:{name:t.siblingNext.oneshot?"browse-oneshot":"browse-book",params:{seriesId:t.siblingNext.seriesId,bookId:t.nextId},query:{context:t.context.origin,contextId:t.context.id}}}},[e("rtl-icon",{attrs:{icon:"mdi-chevron-right",rtl:"mdi-chevron-left"}})],1):t._e()],1),e(n.A,{staticClass:"pa-6",attrs:{fluid:""}},[e(u.A,[t.context.origin===t.ContextOrigin.READLIST&&t.$vuetify.breakpoint.smAndDown?e(o.A,{staticClass:"mb-0",attrs:{type:"info",text:"",dense:"",border:"right"}},[t._v(t._s(t.$t("browse_book.navigation_within_readlist",{name:t.contextName}))+" ")]):t._e()],1),e(u.A,[e(r.A,{attrs:{cols:"4",sm:"4",md:"auto",lg:"auto",xl:"auto"}},[t.book.hasOwnProperty("id")?e("item-card",{attrs:{width:"212",item:t.book,"thumbnail-only":"","no-link":"","action-menu":!1}}):t._e(),t.isInProgress?e("div",{staticClass:"text-caption text-center mt-1",attrs:{title:t.$t("common.read_on",{date:t.readProgressDate})}},[t._v(" "+t._s(t.$tc("common.pages_left",t.pagesLeft))+" ")]):t.isRead?e("div",{staticClass:"text-caption text-center mt-1"},[t._v(" "+t._s(t.$t("common.read_on",{date:t.readProgressDate}))+" ")]):t._e()],1),e(r.A,{attrs:{cols:"8"}},[e(n.A,[e(u.A,[e(r.A,{staticClass:"py-1"},[e("span",{staticClass:"text-h6"},[t._v(t._s(t.book.metadata.title))]),e("router-link",{staticClass:"caption link-underline",class:t.$vuetify.breakpoint.smAndUp?"mx-1":"",style:t.$vuetify.breakpoint.xsOnly?"display: block":"",attrs:{to:{name:"browse-libraries",params:{libraryId:t.book.libraryId}}}},[t._v(t._s(t.$t("searchbox.in_library",{library:t.getLibraryName(t.book)}))+" ")])],1)],1),e(u.A,{staticClass:"text-body-2"},[t.series.metadata&&t.series.metadata.ageRating?e(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[e(a.A,{attrs:{label:"",small:"",link:"",to:{name:"browse-libraries",params:{libraryId:t.series.libraryId},query:{ageRating:[new t.SearchConditionAgeRating(new t.SearchOperatorIs(t.series.metadata.ageRating.toString()))]}}}},[t._v(" "+t._s(t.series.metadata.ageRating)+"+ ")])],1):t._e(),t.series.metadata.language?e(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[e(a.A,{attrs:{label:"",small:"",link:"",to:{name:"browse-libraries",params:{libraryId:t.series.libraryId},query:{language:[new t.SearchConditionLanguage(new t.SearchOperatorIs(t.series.metadata.language))]}}}},[t._v(" "+t._s(t.languageDisplay)+" ")])],1):t._e(),t.series.metadata.readingDirection?e(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[e(a.A,{attrs:{label:"",small:""}},[t._v(" "+t._s(t.$t(`enums.reading_direction.${t.series.metadata.readingDirection}`))+" ")])],1):t._e()],1),e(u.A,{staticClass:"text-caption",attrs:{align:"center"}},[t.book.media.status===t.MediaStatus.UNKNOWN?e(r.A,{attrs:{cols:"auto"}},[t._v(" "+t._s(t.$t("book_card.unknown"))+" ")]):e(r.A,{attrs:{cols:"auto"}},[t._v(" "+t._s(t.$tc("common.pages_n",t.book.media.pagesCount))+" ")]),t.book.metadata.releaseDate?e(r.A,{attrs:{cols:"auto"}},[t._v(" "+t._s(new Intl.DateTimeFormat(t.$i18n.locale,{dateStyle:"long",timeZone:"UTC"}).format(new Date(t.book.metadata.releaseDate)))+" ")]):t._e(),t.book.media.status===t.MediaStatus.OUTDATED?e(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[e(g.A,{attrs:{bottom:"",disabled:!t.isAdmin},scopedSlots:t._u([{key:"activator",fn:function({on:s}){return[e(a.A,t._g({attrs:{label:"",small:"",color:"warning"}},s),[t._v(" "+t._s(t.$t("common.outdated"))+" ")])]}}],null,!1,776088094)},[t._v(" "+t._s(t.$t("browse_book.outdated_tooltip"))+" ")])],1):t._e(),t.unavailable?e(r.A,{staticClass:"py-1 pe-0",attrs:{cols:"auto"}},[e(a.A,{attrs:{label:"",small:"",color:"error"}},[t._v(" "+t._s(t.$t("common.unavailable"))+" ")])],1):t._e()],1),t.$vuetify.breakpoint.smAndUp?[e(u.A,{staticClass:"align-center"},[e(r.A,{attrs:{cols:"auto"}},[e(i.A,{attrs:{color:"accent",small:"",title:t.$t("browse_book.read_book"),to:{name:t.readRouteName,params:{bookId:t.book.id},query:{context:t.context.origin,contextId:t.context.id}},disabled:!t.canRead}},[e(l.A,{attrs:{left:"",small:""}},[t._v("mdi-book-open-page-variant")]),t._v(" "+t._s(t.$t("common.read"))+" ")],1)],1),e(r.A,{attrs:{cols:"auto"}},[e(i.A,{attrs:{small:"",title:t.$t("browse_book.read_incognito"),to:{name:t.readRouteName,params:{bookId:t.book.id},query:{context:t.context.origin,contextId:t.context.id,incognito:!0}},disabled:!t.canRead}},[e(l.A,{attrs:{left:"",small:""}},[t._v("mdi-incognito")]),t._v(" "+t._s(t.$t("common.read"))+" ")],1)],1),e(r.A,{attrs:{cols:"auto"}},[e(i.A,{attrs:{title:t.$t("browse_book.download_file"),small:"",disabled:!t.canDownload,href:t.fileUrl}},[e(l.A,{attrs:{left:"",small:""}},[t._v("mdi-file-download")]),t._v(" "+t._s(t.$t("common.download"))+" ")],1)],1)],1),t.book.metadata.summary?e(u.A,[e(r.A,[e("read-more",{model:{value:t.readMore,callback:function(e){t.readMore=e},expression:"readMore"}},[t._v(t._s(t.book.metadata.summary))])],1)],1):t._e()]:t._e()],2)],1)],1),t.$vuetify.breakpoint.xsOnly?[e(u.A,{staticClass:"align-center"},[e(r.A,{attrs:{cols:"auto"}},[e(i.A,{attrs:{color:"accent",small:"",title:t.$t("browse_book.read_book"),to:{name:t.readRouteName,params:{bookId:t.book.id},query:{context:t.context.origin,contextId:t.context.id}},disabled:!t.canRead}},[e(l.A,{attrs:{left:"",small:""}},[t._v("mdi-book-open-page-variant")]),t._v(" "+t._s(t.$t("common.read"))+" ")],1)],1),e(r.A,{attrs:{cols:"auto"}},[e(i.A,{attrs:{small:"",title:t.$t("browse_book.read_incognito"),to:{name:t.readRouteName,params:{bookId:t.book.id},query:{context:t.context.origin,contextId:t.context.id,incognito:!0}},disabled:!t.canRead}},[e(l.A,{attrs:{left:"",small:""}},[t._v("mdi-incognito")]),t._v(" "+t._s(t.$t("common.read"))+" ")],1)],1),e(r.A,{attrs:{cols:"auto"}},[e(i.A,{attrs:{title:t.$t("browse_book.download_file"),small:"",disabled:!t.canDownload,href:t.fileUrl}},[e(l.A,{attrs:{left:"",small:""}},[t._v("mdi-file-download")]),t._v(" "+t._s(t.$t("common.download"))+" ")],1)],1)],1),t.book.metadata.summary?e(u.A,[e(r.A,[e("read-more",{model:{value:t.readMore,callback:function(e){t.readMore=e},expression:"readMore"}},[t._v(t._s(t.book.metadata.summary))])],1)],1):t._e()]:t._e(),t.series.metadata.publisher?e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("common.publisher")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[e(a.A,{staticClass:"me-2",attrs:{title:t.series.metadata.publisher,to:{name:"browse-libraries",params:{libraryId:t.series.libraryId},query:{publisher:[new t.SearchConditionPublisher(new t.SearchOperatorIs(t.series.metadata.publisher))]}},label:"",small:"",outlined:"",link:""}},[t._v(t._s(t.series.metadata.publisher)+" ")])],1)],1):t._e(),t.series.metadata.genres.length>0?e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("common.genre")))]),e(r.A,{staticClass:"py-1 text-capitalize",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[e("vue-horizontal",{scopedSlots:t._u([{key:"btn-prev",fn:function(){return[e(i.A,{attrs:{icon:"",small:""}},[e(l.A,[t._v("mdi-chevron-left")])],1)]},proxy:!0},{key:"btn-next",fn:function(){return[e(i.A,{attrs:{icon:"",small:""}},[e(l.A,[t._v("mdi-chevron-right")])],1)]},proxy:!0}],null,!1,187429412)},t._l(t.$_.sortBy(t.series.metadata.genres),(function(s,o){return e(a.A,{key:o,staticClass:"me-2",attrs:{title:s,to:{name:"browse-libraries",params:{libraryId:t.series.libraryId},query:{genre:[new t.SearchConditionGenre(new t.SearchOperatorIs(s))]}},label:"",small:"",outlined:"",link:""}},[t._v(t._s(s)+" ")])})),1)],1)],1):t._e(),t._l(t.displayedRoles,(function(s){return e(u.A,{key:s,staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(" "+t._s(t.$te(`author_roles.${s}`)?t.$t(`author_roles.${s}`):s)+" ")]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[e("vue-horizontal",{scopedSlots:t._u([{key:"btn-prev",fn:function(){return[e(i.A,{attrs:{icon:"",small:""}},[e(l.A,[t._v("mdi-chevron-left")])],1)]},proxy:!0},{key:"btn-next",fn:function(){return[e(i.A,{attrs:{icon:"",small:""}},[e(l.A,[t._v("mdi-chevron-right")])],1)]},proxy:!0}],null,!0)},t._l(t.authorsByRole[s],(function(o,i){return e(a.A,{key:i,staticClass:"me-2",attrs:{title:o,to:{name:"browse-libraries",params:{libraryId:t.book.libraryId},query:{[s]:[o]}},label:"",small:"",outlined:"",link:""}},[t._v(t._s(o)+" ")])})),1)],1)],1)})),t.book.metadata.tags.length>0?e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$i18n.t("common.tags")))]),e(r.A,{staticClass:"py-1 text-capitalize",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[e("vue-horizontal",{scopedSlots:t._u([{key:"btn-prev",fn:function(){return[e(i.A,{attrs:{icon:"",small:""}},[e(l.A,[t._v("mdi-chevron-left")])],1)]},proxy:!0},{key:"btn-next",fn:function(){return[e(i.A,{attrs:{icon:"",small:""}},[e(l.A,[t._v("mdi-chevron-right")])],1)]},proxy:!0}],null,!1,187429412)},t._l(t.book.metadata.tags,(function(s,o){return e(a.A,{key:o,staticClass:"me-2",attrs:{title:s,to:{name:"browse-libraries",params:{libraryId:t.book.libraryId},query:{tag:[new t.SearchConditionTag(new t.SearchOperatorIs(s))]}},label:"",small:"",outlined:"",link:""}},[t._v(t._s(s)+" ")])})),1)],1)],1):t._e(),e(u.A,[e(r.A,{staticClass:"pb-1",attrs:{cols:"12"}},[e("collections-expansion-panels",{attrs:{collections:t.collections},scopedSlots:t._u([{key:"prepend",fn:function(s){return[e(g.A,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:o}){return[e(i.A,t._g({staticClass:"me-2",attrs:{icon:""},on:{click:function(e){return t.removeFromCollection(s.collection.id)}}},o),[e(l.A,[t._v("mdi-playlist-remove")])],1)]}}],null,!0)},[e("span",[t._v(t._s(t.$t("browse_book.remove_from_collection")))])])]}}],null,!1,2743567101)})],1),e(r.A,{staticClass:"pt-1",attrs:{cols:"12"}},[e("read-lists-expansion-panels",{attrs:{"read-lists":t.readLists},scopedSlots:t._u([{key:"prepend",fn:function(s){return[e(g.A,{attrs:{bottom:""},scopedSlots:t._u([{key:"activator",fn:function({on:o}){return[e(i.A,t._g({staticClass:"me-2",attrs:{icon:""},on:{click:function(e){return t.removeFromReadList(s.readlist.id)}}},o),[e(l.A,[t._v("mdi-book-remove")])],1)]}}],null,!0)},[e("span",[t._v(t._s(t.$t("browse_book.remove_from_readlist")))])])]}}],null,!1,3445749044)})],1)],1),t.book.metadata.links.length>0?e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.links")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},t._l(t.book.metadata.links,(function(s,o){return e(a.A,{key:o,staticClass:"me-2",attrs:{href:s.url,rel:"noreferrer",target:"_blank",label:"",small:"",outlined:"",link:""}},[t._v(" "+t._s(s.label)+" "),e(l.A,{staticClass:"ps-1",attrs:{"x-small":"",color:"grey"}},[t._v(" mdi-open-in-new ")])],1)})),1)],1):t._e(),e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.size")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(t.book.size))])],1),t.book.media.comment?e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.comment")))]),e(r.A,{staticClass:"py-1 error--text font-weight-bold",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(t.mediaComment))])],1):t._e(),e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.format")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(t.format.type))])],1),t.book.metadata.isbn?e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.isbn")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(t.book.metadata.isbn))])],1):t._e(),e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.file")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(t.book.url))])],1),e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.date_created")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(new Intl.DateTimeFormat(t.$i18n.locale,{dateStyle:"long",timeStyle:"short"}).format(new Date(t.book.created)))+" ")])],1),e(u.A,{staticClass:"align-center text-caption"},[e(r.A,{staticClass:"py-1 text-uppercase",attrs:{cols:"4",sm:"3",md:"2",xl:"1"}},[t._v(t._s(t.$t("browse_book.date_modified")))]),e(r.A,{staticClass:"py-1",attrs:{cols:"8",sm:"9",md:"10",xl:"11"}},[t._v(t._s(new Intl.DateTimeFormat(t.$i18n.locale,{dateStyle:"long",timeStyle:"short"}).format(new Date(t.book.lastModified)))+" ")])],1)],2)],1)},k=[],v=(s(14602),s(28743),s(82753)),x=s(72448),y=s(75723),A=s(33060),$=s(50536),f=s(9401),C=s(33513),I=s(79957),w=s(52846),S=s(85471),L=s(95079),R=s(13044),D=s(4291),P=s(40889),E=s(41272),O=s(23850),T=s(24636),H=s(94845),N=s(49395),q=s(19447);const B=s(1999);var M=S.Ay.extend({name:"BrowseOneshot",components:{OneshotActionsMenu:N.A,CollectionsExpansionPanels:H.A,ReadMore:D.A,ToolbarSticky:x.A,ItemCard:v.A,ReadListsExpansionPanels:L.A,VueHorizontal:P.A,RtlIcon:T.A},data:()=>({SearchConditionPublisher:q.oy,SearchConditionGenre:q.BK,SearchConditionTag:q.iT,SearchConditionLanguage:q.oF,SearchConditionAgeRating:q.CM,SearchOperatorIs:q.Tr,MediaStatus:I.nl,ContextOrigin:R.E,book:{},series:{},context:{},siblings:[],siblingPrevious:{},siblingNext:{},contextName:"",collections:[],readLists:[],readMore:!1}),async created(){this.loadSeries(this.seriesId),this.$eventHub.$on(w.P,this.seriesChanged),this.$eventHub.$on(w.Mi,this.seriesDeleted),this.$eventHub.$on(w.vk,this.bookChanged),this.$eventHub.$on(w.Qg,this.bookDeleted),this.$eventHub.$on(w.pU,this.readProgressChanged),this.$eventHub.$on(w.Ih,this.readProgressChanged),this.$eventHub.$on(w.yn,this.libraryDeleted),this.$eventHub.$on(w.YP,this.readListChanged),this.$eventHub.$on(w._X,this.readListChanged),this.$eventHub.$on(w.Vp,this.readListChanged),this.$eventHub.$on(w.Ep,this.collectionChanged),this.$eventHub.$on(w.Gx,this.collectionChanged),this.$eventHub.$on(w.HS,this.collectionChanged)},beforeDestroy(){this.$eventHub.$off(w.P,this.seriesChanged),this.$eventHub.$off(w.Mi,this.seriesDeleted),this.$eventHub.$off(w.vk,this.bookChanged),this.$eventHub.$off(w.Qg,this.bookDeleted),this.$eventHub.$off(w.pU,this.readProgressChanged),this.$eventHub.$off(w.Ih,this.readProgressChanged),this.$eventHub.$off(w.yn,this.libraryDeleted),this.$eventHub.$off(w.YP,this.readListChanged),this.$eventHub.$off(w._X,this.readListChanged),this.$eventHub.$off(w.Vp,this.readListChanged),this.$eventHub.$off(w.Ep,this.collectionChanged),this.$eventHub.$off(w.Gx,this.collectionChanged),this.$eventHub.$off(w.HS,this.collectionChanged)},props:{seriesId:{type:String,required:!0}},async beforeRouteUpdate(t,e,s){t.params.seriesId!==e.params.seriesId&&(this.readMore=!1,this.loadSeries(t.params.seriesId)),s()},computed:{readRouteName(){return(0,A.Z)(this.book.media)},isAdmin(){return this.$store.getters.meAdmin},unavailable(){return this.book.deleted||this.$store.getters.getLibraryById(this.book.libraryId).unavailable},canRead(){return"READY"===this.book.media.status&&this.$store.getters.mePageStreaming&&!this.unavailable},canDownload(){return this.$store.getters.meFileDownload&&!this.unavailable},thumbnailUrl(){return(0,C.TJ)(this.seriesId)},fileUrl(){return(0,C.pv)(this.book.id)},format(){return(0,A.d)(this.book.media)},authorsByRole(){return(0,y.R)(this.book.metadata.authors)},isRead(){return(0,$.wP)(this.book)===I.RJ.READ},isUnread(){return(0,$.wP)(this.book)===I.RJ.UNREAD},isInProgress(){return(0,$.wP)(this.book)===I.RJ.IN_PROGRESS},pagesLeft(){return(0,$.yW)(this.book)},readProgressPercentage(){return(0,$.mq)(this.book)},readProgressDate(){if(this.book.readProgress)return new Intl.DateTimeFormat(this.$i18n.locale,{dateStyle:"medium",timeStyle:"short"}).format(this.book.readProgress.readDate)},previousId(){var t;return(null===(t=this.siblingPrevious)||void 0===t||null===(t=t.id)||void 0===t?void 0:t.toString())||"0"},nextId(){var t;return(null===(t=this.siblingNext)||void 0===t||null===(t=t.id)||void 0===t?void 0:t.toString())||"0"},mediaComment(){return(0,O.q)(this.book.media.comment)},parentLocation(){return this.context.origin===R.E.READLIST?{name:"browse-readlist",params:{readListId:this.context.id}}:this.context.origin===R.E.COLLECTION?{name:"browse-collection",params:{collectionId:this.context.id}}:{name:"browse-libraries",params:{libraryId:this.book.libraryId}}},displayedRoles(){const t=this.$_.uniq([...E.B,...this.book.metadata.authors.map((t=>t.role))]);return t.filter((t=>this.authorsByRole[t]))},languageDisplay(){var t;return(null===(t=B(this.series.metadata.language))||void 0===t||null===(t=t.language())||void 0===t?void 0:t.descriptions()[0])||this.series.metadata.language}},methods:{getLibraryName(t){return this.$store.getters.getLibraryById(t.libraryId).name},libraryDeleted(t){t.libraryId===this.book.libraryId&&this.$router.push({name:"home"})},readListChanged(t){(t.bookIds.includes(this.book.id)||this.readLists.map((t=>t.id)).includes(t.readListId))&&this.$komgaBooks.getReadLists(this.book.id).then((t=>this.readLists=t))},collectionChanged(t){(t.seriesIds.includes(this.seriesId)||this.collections.map((t=>t.id)).includes(t.collectionId))&&this.$komgaSeries.getCollections(this.seriesId).then((t=>this.collections=t))},seriesChanged(t){t.seriesId===this.seriesId&&this.$komgaSeries.getOneSeries(this.seriesId).then((t=>this.series=t))},seriesDeleted(t){t.seriesId===this.seriesId&&this.$router.push({name:"browse-libraries",params:{libraryId:this.series.libraryId}})},bookChanged(t){t.bookId===this.book.id&&this.loadBook(this.seriesId)},bookDeleted(t){t.bookId===this.book.id&&this.$router.push({name:"browse-libraries",params:{libraryId:this.book.libraryId}})},readProgressChanged(t){t.bookId===this.book.id&&this.loadBook(this.seriesId)},async loadSeries(t){this.$komgaSeries.getOneSeries(t).then((t=>this.series=t)),this.$komgaSeries.getCollections(t).then((t=>this.collections=t)),this.$route.query.contextId&&this.$route.query.context&&Object.values(R.E).includes(this.$route.query.context)&&(this.context={origin:this.$route.query.context,id:this.$route.query.contextId},this.series.context=this.context),await this.loadBook(t)},async loadBook(t){this.book=(await this.$komgaBooks.getBooksList({condition:new q.kq(new q.Tr(t))})).content[0],this.$route.query.contextId&&this.$route.query.context&&Object.values(R.E).includes(this.$route.query.context)&&(this.context={origin:this.$route.query.context,id:this.$route.query.contextId},this.book.context=this.context,this.context.origin===R.E.READLIST&&this.$komgaReadLists.getOneReadList(this.context.id).then((t=>this.contextName=t.name))),(null===this||void 0===this?void 0:this.context.origin)===R.E.READLIST?this.$komgaReadLists.getBooks(this.context.id,{unpaged:!0}).then((t=>this.siblings=t.content)):this.siblings={},this.$komgaBooks.getReadLists(this.book.id).then((t=>this.readLists=t)),this.$_.has(this.book,"metadata.title")&&(document.title=`Komga - ${(0,f.P)(this.book.metadata.title,this.book.seriesTitle)}`),(null===this||void 0===this?void 0:this.context.origin)===R.E.READLIST?this.$komgaReadLists.getBookSiblingNext(this.context.id,this.book.id).then((t=>this.siblingNext=t)).catch((t=>this.siblingNext={})):this.siblingNext={},(null===this||void 0===this?void 0:this.context.origin)===R.E.READLIST?this.$komgaReadLists.getBookSiblingPrevious(this.context.id,this.book.id).then((t=>this.siblingPrevious=t)).catch((t=>this.siblingPrevious={})):this.siblingPrevious={}},analyze(){this.$komgaBooks.analyzeBook(this.book)},refreshMetadata(){this.$komgaBooks.refreshMetadata(this.book)},editBook(){this.$store.dispatch("dialogUpdateOneshots",{series:this.series,book:this.book})},removeFromReadList(t){const e=this.readLists.find((e=>e.id==t)),s=Object.assign({},{bookIds:null===e||void 0===e?void 0:e.bookIds.filter((t=>t!=this.book.id))});0==s.bookIds.length?this.$komgaReadLists.deleteReadList(e.id):this.$komgaReadLists.patchReadList(e.id,s)},removeFromCollection(t){const e=this.collections.find((e=>e.id==t)),s=Object.assign({},{seriesIds:null===e||void 0===e?void 0:e.seriesIds.filter((t=>t!=this.seriesId))});0==s.seriesIds.length?this.$komgaCollections.deleteCollection(e.id):this.$komgaCollections.patchCollection(e.id,s)}}}),U=M,z=s(81656),F=(0,z.A)(U,p,k,!1,null,"01d8f4c4",null),G=F.exports}}]);
//# sourceMappingURL=browse-oneshot.a5796689.js.map