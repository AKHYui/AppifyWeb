"use strict";(self["webpackChunkkomga_webui"]=self["webpackChunkkomga_webui"]||[]).push([[1260],{4395:function(e,t,a){a.d(t,{A:function(){return A}});var i=a(73847),s=a(16684),n=a(18748),o=a(94026),l=a(5291),c=a(69791),r=a(30376),g=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(r.A,{attrs:{"offset-y":""},scopedSlots:e._u([{key:"activator",fn:function({on:a}){return[t(i.A,e._g({attrs:{icon:""}},a),[t(s.A,[e._v("mdi-view-grid-plus")])],1)]}}])},[t(n.A,{attrs:{dark:e.dark}},[t(l.A,{model:{value:e.selection,callback:function(t){e.selection=t},expression:"selection"}},e._l(e.items,(function(a,i){return t(o.A,{key:i,on:{click:function(t){return e.setPageSize(a)}}},[t(c.UZ,[e._v(e._s(a))])],1)})),1)],1)],1)},h=[],u=a(85471),d=u.Ay.extend({name:"PageSizeSelect",data:()=>({selection:0}),props:{items:{type:Array,default:()=>[20,50,100,200,500]},value:{type:Number,required:!0},dark:{type:Boolean,default:!1}},watch:{value:{handler(e){this.selection=this.items.findIndex((t=>t===e))},immediate:!0}},methods:{setPageSize(e){this.$emit("input",e)}}}),m=d,p=a(81656),_=(0,p.A)(m,g,h,!1,null,"57c54c90",null),A=_.exports},38729:function(e,t,a){a.r(t),a.d(t,{default:function(){return T}});var i=a(90623),s=a(73847),n=a(30089),o=a(21253),l=a(1231),c=a(70793),r=a(92872),g=a(16684),h=a(13812),u=a(6231),d=a(22369),m=a(80700),p=a(40005),_=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(c.A,{staticClass:"pa-6",attrs:{fluid:""}},[t(i.A,{staticClass:"body-2",attrs:{type:"warning",dismissible:"",text:""}},[t("div",[e._v(e._s(e.$t("duplicate_pages.info")))])]),0===e.totalPages?t("empty-state",{attrs:{title:e.$t("duplicate_pages.empty_title"),icon:"mdi-check","icon-color":"success"}}):e._e(),e.totalPages>0?[t(d.A,{attrs:{align:"center"}},[t(l.A,{attrs:{cols:"auto"}},[e.totalPages>1?t(u.A,{attrs:{"total-visible":e.paginationVisible,length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}):e._e()],1),t(p.A),e._l(e.sortOptions,(function(a){return t(l.A,{key:a.key,attrs:{cols:"auto"}},[t(s.A,{attrs:{rounded:"",small:"",color:e.sortActive.key===a.key?"primary":""},on:{click:function(t){return e.setSort(a.key)}}},[e._v(" "+e._s(a.name)+" "),e.sortActive.key===a.key?t(g.A,{staticClass:"ms-2"},[e._v(" "+e._s("desc"===e.sortActive.order?"mdi-sort-variant":"mdi-sort-reverse-variant")+" ")]):e._e()],1)],1)})),t(l.A,[t("page-size-select",{attrs:{items:[1,2,5,10,20,50]},model:{value:e.pageSize,callback:function(t){e.pageSize=t},expression:"pageSize"}})],1)],2),t(d.A,e._l(e.elements,(function(a,i){return t(m.vt,{key:i},[t("page-hash-unknown-card",{directives:[{name:"show",rawName:"v-show",value:!e.hiddenElements.includes(a),expression:"!hiddenElements.includes(element)"}],staticClass:"ma-2",attrs:{hash:a},on:{"image-clicked":function(t){return e.showDialogImage(a)},"matches-clicked":function(t){return e.showDialogMatches(a)},created:function(t){return e.pageHashCreated(a)}}})],1)})),1),t(d.A,{attrs:{justify:"center"}},[t(l.A,{attrs:{cols:"auto"}},[t(s.A,{attrs:{disabled:e.remainingCount<1},on:{click:function(t){return e.actionRemaining(e.PageHashAction.IGNORE)}}},[e._v(e._s(e.$t("duplicate_pages.action_ignore_remaining",{count:e.remainingCount}))+" ")])],1),t(l.A,{attrs:{cols:"auto"}},[t(s.A,{attrs:{disabled:e.remainingCount<1,color:"warning"},on:{click:function(t){return e.confirmRemaining(e.PageHashAction.DELETE_MANUAL)}}},[e._v(e._s(e.$t("duplicate_pages.action_manual_delete_remaining",{count:e.remainingCount}))+" ")])],1),t(l.A,{attrs:{cols:"auto"}},[t(s.A,{attrs:{disabled:e.remainingCount<1,color:"warning"},on:{click:function(t){return e.confirmRemaining(e.PageHashAction.DELETE_AUTO)}}},[e._v(e._s(e.$t("duplicate_pages.action_auto_delete_remaining",{count:e.remainingCount}))+" ")])],1)],1),t(d.A,{attrs:{align:"center"}},[t(l.A,{attrs:{cols:"auto"}},[e.totalPages>1?t(u.A,{attrs:{"total-visible":e.paginationVisible,length:e.totalPages},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}}):e._e()],1)],1)]:e._e(),t(r.A,{model:{value:e.dialogImage,callback:function(t){e.dialogImage=t},expression:"dialogImage"}},[t(n.A,[t(o.OQ,[t(h.A,{staticStyle:{cursor:"zoom-out"},attrs:{contain:"",src:e.pageHashUnknownThumbnailUrl(e.dialogImagePageHash)},on:{click:function(t){e.dialogImage=!1}}})],1)],1)],1),t(r.A,{attrs:{scrollable:""},model:{value:e.dialogMatches,callback:function(t){e.dialogMatches=t},expression:"dialogMatches"}},[t(n.A,[t(o.OQ,[t("page-hash-matches-table",{staticClass:"my-2",attrs:{hash:e.dialogMatchesPageHash}})],1),t(o.SL,[t(s.A,{attrs:{text:""},on:{click:function(t){e.dialogMatches=!1}}},[e._v(e._s(e.$t("common.close")))])],1)],1)],1),t("confirmation-dialog",{attrs:{title:e.$t(`duplicate_pages.action_${e.dialogConfirmI18n}_remaining`,{count:e.remainingCount}),"body-html":e.$t(`duplicate_pages.confirm_${e.dialogConfirmI18n}_remaining`,{count:e.remainingCount}),"button-confirm":e.$t(`duplicate_pages.action_${e.dialogConfirmI18n}_remaining`,{count:e.remainingCount}),"button-confirm-color":"warning"},on:{confirm:function(t){return e.actionRemaining(e.confirmAction)}},model:{value:e.modalConfirmRemaining,callback:function(t){e.modalConfirmRemaining=t},expression:"modalConfirmRemaining"}})],2)},A=[],f=(a(28743),a(14602),a(85471)),k=a(33513),v=a(24632),y=function(){var e=this,t=e._self._c;e._self._setupProxy;return t(n.A,[t(c.A,{attrs:{fluid:""}},[t(d.A,[t(l.A,[t(h.A,{staticStyle:{cursor:"zoom-in"},attrs:{width:"200",height:"300",contain:"",src:e.pageHashUnknownThumbnailUrl(e.hash,500)},on:{click:function(t){return e.$emit("image-clicked")}}})],1),t(l.A,[t(o.OQ,{staticStyle:{"min-width":"200px"}},[t(c.A,[t(d.A,[t(l.A,[t("div",[e._v(e._s(e.getFileSize(e.hash.size)||e.$t("duplicate_pages.unknown_size")))])])],1),t(d.A,[t(l.A,[t(s.A,{attrs:{outlined:"",rounded:""},on:{click:function(t){return e.$emit("matches-clicked")}}},[e._v(" "+e._s(e.$tc("duplicate_pages.matches_n",e.hash.matchCount))+" ")])],1)],1),t(d.A,[t(l.A,[e.hash.size?t("div",[e._v(e._s(e.$t("duplicate_pages.delete_to_save",{size:e.getFileSize(e.hash.size*e.hash.matchCount)}))+" ")]):e._e()])],1)],1)],1)],1)],1)],1),t(o.SL,[t(s.A,{attrs:{text:""},on:{click:e.ignore}},[e._v(e._s(e.$t("duplicate_pages.action_ignore")))]),t(s.A,{attrs:{text:""},on:{click:e.deleteManual}},[e._v(e._s(e.$t("duplicate_pages.action_delete_manual")))]),t(s.A,{attrs:{text:"",disabled:!e.hash.size},on:{click:e.deleteAuto}},[e._v(e._s(e.$t("duplicate_pages.action_delete_auto")))])],1)],1)},P=[],b=a(80312),w=a(26949),C=f.Ay.extend({name:"PageHashUnknownCard",props:{hash:{type:Object}},data(){return{pageHashUnknownThumbnailUrl:k.Th,getFileSize:w.K}},methods:{ignore(){this.createPageHash(b.s.IGNORE)},deleteManual(){this.createPageHash(b.s.DELETE_MANUAL)},deleteAuto(){this.createPageHash(b.s.DELETE_AUTO)},async createPageHash(e){try{await this.$komgaPageHashes.createOrUpdatePageHash({hash:this.hash.hash,size:this.hash.size,action:e}),this.$emit("created")}catch(t){}}}}),z=C,$=a(81656),S=(0,$.A)(z,y,P,!1,null,null,null),H=S.exports,E=a(4395),x=a(1324),U=a(32837),I=f.Ay.extend({name:"DuplicatePagesUnknown",components:{ConfirmationDialog:U.A,EmptyState:x.A,PageHashUnknownCard:H,PageHashMatchesTable:v.A,PageSizeSelect:E.A},data:function(){return{elements:[],hiddenElements:[],totalElements:0,page:1,totalPages:void 0,sortActive:{key:"totalSize",order:"desc"},dialogImage:!1,dialogMatches:!1,dialogImagePageHash:{},dialogMatchesPageHash:{},modalConfirmRemaining:!1,confirmAction:{},dialogConfirmI18n:"",pageHashUnknownThumbnailUrl:k.Th}},async mounted(){await this.loadData(this.page,this.sortActive)},watch:{page(e){this.loadData(e,this.sortActive)},sortActive(e){this.loadData(this.page,e)}},computed:{PageHashAction(){return b.s},sortOptions(){return[{name:this.$t("duplicate_pages.filter.total_size").toString(),key:"totalSize"},{name:this.$t("duplicate_pages.filter.size").toString(),key:"fileSize"},{name:this.$t("duplicate_pages.filter.count").toString(),key:"matchCount"}]},paginationVisible(){switch(this.$vuetify.breakpoint.name){case"xs":case"sm":case"md":return 5;case"lg":return 10;case"xl":default:return 15}},pageSize:{get:function(){return this.$store.state.persistedState.duplicatesNewPageSize},set:function(e){this.$store.commit("setDuplicatesNewPageSize",e),this.loadData(this.page,this.sortActive)}},remainingCount(){return this.elements.length-this.hiddenElements.length}},methods:{async loadData(e,t){const a={page:e-1,size:this.pageSize,sort:[`${t.key},${t.order}`]},i=await this.$komgaPageHashes.getUnknownHashes(a);this.totalElements=i.totalElements,this.totalPages=i.totalPages,this.elements=i.content,this.hiddenElements=[],this.page>this.totalPages&&(this.page=this.totalPages)},setSort(e){this.sortActive.key===e&&"desc"===this.sortActive.order?this.sortActive={key:e,order:"asc"}:this.sortActive={key:e,order:"desc"}},showDialogImage(e){this.dialogImagePageHash=e,this.dialogImage=!0},showDialogMatches(e){this.dialogMatchesPageHash=e,this.dialogMatches=!0},pageHashCreated(e){this.hiddenElements.push(e),this.elements.every((e=>this.hiddenElements.includes(e)))&&this.loadData(this.page,this.sortActive)},confirmRemaining(e){this.confirmAction=e,this.dialogConfirmI18n=e===b.s.DELETE_AUTO?"auto_delete":"manual_delete",this.modalConfirmRemaining=!0},async actionRemaining(e){for(const t of this.elements)this.hiddenElements.includes(t)||this.$komgaPageHashes.createOrUpdatePageHash({hash:t.hash,size:t.size,action:e}).then((()=>this.pageHashCreated(t)))}}}),D=I,M=(0,$.A)(D,_,A,!1,null,"9f1ccb00",null),T=M.exports}}]);
//# sourceMappingURL=duplicate-pages-new.fbd68591.js.map